/*! TT-UI Lib 0.6.24.19 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ttui-multiselect-hierarchy-tree"),function(a,b,c){"use strict";function d(a,c,d){function e(){return h.nodes.map(function(a){return a.getTotalCounts()}).reduce(function(a,b){return a.total+=b.total,a.selected+=b.selected,a.included+=b.included,a},{total:0,selected:0,included:0})}function f(a,b){if(b)for(var c=a.length-1;c>=0;c--)f(a[c].nodes,b),b(a[c])}function g(a){var b=[];(a.isIncluded()||a.isPartiallySelected())&&b.push({title:a.title,id:a.id,selectionType:a.selectionType});for(var c=a.nodes.length-1;c>=0;c--)b=b.concat(g(a.nodes[c]));return b}var h=this;h.counts={},h.isSingleSelect="single"===h.selectMode,h.notifySelectionChange=function(){var c=h.getSelection();b.equals(h.selectionModel,c)||(h.selectionModel=c),h.counts=e(),a.$emit("selectionChange",c)},h.getSelection=function(){for(var a=[],b=h.nodes.length-1;b>=0;b--)a=a.concat(g(h.nodes[b]));return a},h.isAllSelected=function(){return(h.nodes||[]).every(function(a){return a.isSelected()})},h.isAllPossibleSelected=function(){return!this.getAllNodes().some(function(a){return a.canSelect()&&!a.isIncluded()})},h.toggleSelectAll=function(){this.isAllPossibleSelected()?h.unselectAll():h.selectAll(),h.notifySelectionChange()},h.getAllNodes=function(){var a=[];return f(this.nodes,function(b){a.push(b)}),a},h.selectAll=function(){f(this.nodes,function(a){a.select(!1)})},h.unselectAll=function(){f(this.nodes,function(a){a.unselect(!1)})};var i={canSelect:function(b){return d.canSelect(b,h,a.hierarchyTreeAttrs)},canUnselect:function(b){return d.canUnselect(b,h,a.hierarchyTreeAttrs)},canUpgradeSelection:function(b){return d.canUpgradeSelection(b,h,a.hierarchyTreeAttrs)},beforeSelect:function(b){return d.beforeSelect(b,h,a.hierarchyTreeAttrs)},afterSelect:function(b){return d.afterSelect(b,h,a.hierarchyTreeAttrs)},beforeUnselect:function(b){return d.beforeUnselect(b,h,a.hierarchyTreeAttrs)},afterUnselect:function(b){return d.afterUnselect(b,h,a.hierarchyTreeAttrs)}},j=a.$watch("mshtCtrl.nodes",function(a){a&&a.length>0&&(j(),h.nodes=(a||[]).map(function(a){return c.create(a,i)}))},!0)}function e(){var a=this;a.expanded=!1,a.model.parent||(a.expanded=!0),a.getIconClasses=function(){var b="glyphicon glyphicon-ttui ";return b=a.iconHovered?b.concat("glyphicon-chevron-circle-right-black "):b.concat("glyphicon-chevron-circle-right "),a.expanded&&!a.iconHovered&&(b=b.concat("animate ")),!a.expanded&&a.iconHovered&&(b=b.concat("animate-back ")),b},a.getNodeContentClasses=function(){var b="tree-node-content ";return a.hasChildren()||(b=b.concat("no-children ")),a.hasChildren()&&(b=b.concat("header ")),a.hovered&&(b=b.concat("hover ")),a.model.isPartiallySelected()&&(b=b.concat("partially-selected ")),a.model.isSelected()||a.model.canSelect()||(b=b.concat("select-not-allowed ")),a.model.isSelected()&&!a.model.canUnselect()&&(b=b.concat("unselect-not-allowed ")),b},a.hover=function(b){a.hovered=b},a.iconHover=function(b){a.iconHovered=b},a.hasChildren=function(){if(a.model)return(a.model.nodes||[]).length>0},a.toggleExpand=function(){a.expanded=!a.expanded},a.labelClick=function(){a.hasChildren()&&!a.model.canSelect()?a.toggleExpand():a.toggleSelect()},a.isSelected=function(){return a.model.isIncluded()||a.model.isPartiallySelected()}}function f(a){return{require:["multiselectHierarchyTreeNode","^multiselectHierarchyTree"],restrict:"A",controller:"MultiselectHierarchyTreeNodeController as mshtNodeCtrl",scope:{},bindToController:{model:"=",searchText:"="},templateUrl:a.templatePath+"multiselect-ht-node.tpl.html",link:function(b,c,d,e){b.recursionTemplate=a.templatePath+"multiselect-ht-recursion.tpl.html";var f=e[0],g=e[1];f.toggleSelect=function(){f.model.toggleSelect(),g.notifySelectionChange()}}}}function g(a,b){return{require:"multiselectHierarchyTree",restrict:"E",controller:"MultiselectHierarchyTreeController as mshtCtrl",scope:{},bindToController:{nodes:"="},link:function(a,c,d,e){a.hierarchyTreeAttrs=d,b(function(){e.notifySelectionChange()},0)},templateUrl:a.templatePath+"multiselect-ht.tpl.html"}}function h(){function a(a,b,c){var d=a.getContext("2d");d.canvas.height=b*c,d.canvas.width=2e3,d.fillStyle="#FFFFFF";for(var e=0;e<b;e++)if(e%2==0){var f=e*c;d.fillRect(0,f,2e3,c)}d.canvas.style.position="absolute",d.canvas.style.zIndex="-1",d.canvas.style.top="0px",d.canvas.style.left="0px"}return{restrict:"A",scope:{rowHeight:"@"},transclude:!0,template:"<canvas width='0' height='0'></canvas><div ng-transclude></div>",link:function(b,c){b.$watch(function(){return c.find("li").length*b.rowHeight},function(){a(c.find("canvas")[0],c.find("li").length,b.rowHeight)})}}}function i(){function a(b,c){return c?(c=c.toLowerCase(),b.filter(function(b){var d=b.title.toLowerCase(),e="";return b.parent&&(e=b.parent.title.toLowerCase()),d.indexOf(c.toLowerCase())>=0||e.indexOf(c.toLowerCase())>=0||!b.parent||a(b.nodes,c).length>0})):b}return a}function j(a){function b(b){b.selectionType=a.SELECTED,f(b)}function d(b){b.selectionType=a.NONE,f(b)}function e(b){b.selectionType=a.INHERIT_SELECTED,f(b)}function f(a){for(var b=a.nodes.length-1;b>=0;b--)a.isIncluded()?e(a.nodes[b]):d(a.nodes[b])}function g(a){for(var b={total:1,included:a.isIncluded()?1:0,selected:a.isSelected()?1:0},c=a.nodes.length-1;c>=0;c--){var d=g(a.nodes[c]);b.total+=d.total,b.included+=d.included,b.selected+=d.selected}return b}var h=function(b,c,d){this.title=b.title,this.id=b.id,this.selectionType=b.selectionType?b.selectionType:a.NONE,this.parent=c,this.events=d,this.nodes=(b.nodes||[]).map(function(a){return new h(a,this,d)}.bind(this))};return h.prototype.getKey=function(){return this.id},h.prototype.getSelectionType=function(){return this.selectionType},h.prototype.canSelect=function(){return!this.events||!this.events.canSelect||this.events.canSelect(this)},h.prototype.canUnselect=function(){return!this.events||!this.events.canUnselect||this.events.canUnselect(this)},h.prototype.canUpgradeSelection=function(){return!this.events||!this.events.canUpgradeSelection||this.events.canUpgradeSelection(this)},h.prototype.isLeafNode=function(){return 0===this.nodes.length},h.prototype._fireEvent=function(a,b){this.events&&this.events[a]&&this.events[a](b)},h.prototype.select=function(a){this.canSelect()&&(this._fireEvent("beforeSelect",this),b(this),a&&this.parent&&this.parent.notifyChildSelectionChange(),this._fireEvent("afterSelect",this))},h.prototype.unselect=function(a){this.canUnselect()&&(this._fireEvent("beforeUnselect",this),d(this),a&&this.parent&&this.parent.notifyChildSelectionChange(),this._fireEvent("afterUnselect",this))},h.prototype.notifyChildSelectionChange=function(){if(this.nodes.some(function(b){return b.selectionType!==a.NONE}))if(this.nodes.some(function(a){return!a.isIncluded()})){for(var c=this.nodes.length-1;c>=0;c--)this.nodes[c].isInheritSelected()&&b(this.nodes[c]);this.selectionType=a.PARTIAL_SELECTED}else this.canUpgradeSelection()&&this.canSelect()&&b(this);else d(this)},h.prototype.isIncluded=function(){return this.selectionType===a.SELECTED||this.selectionType===a.INHERIT_SELECTED},h.prototype.isSelected=function(){return this.selectionType===a.SELECTED},h.prototype.isPartiallySelected=function(){return this.selectionType===a.PARTIAL_SELECTED},h.prototype.isInheritSelected=function(){return this.selectionType===a.INHERIT_SELECTED},h.prototype.getTotalCounts=function(){return g(this)},h.prototype.getTotalCountsTotal=function(){return this.nodes.length},h.prototype.getTotalCountsIncluded=function(){for(var a=0,b=0;b<this.nodes.length;b++)a+=this.nodes[b].isIncluded()?1:0;return a},h.prototype.toggleSelect=function(){this.isIncluded()?this.unselect(!0):this.select(!0)},{create:function(a,b){return new h(a,c,b)}}}function k(){return{canSelect:function(a,b,c){return!0},canUnselect:function(a,b,c){return!0},canUpgradeSelection:function(a,b,c){return!0},beforeSelect:function(a,b,c){},afterSelect:function(a,b,c){},beforeUnselect:function(a,b,c){},afterUnselect:function(a,b,c){}}}var l=b.module("TT-UI.MultiselectHierarchyTree.Controllers.MultiselectHierarchyTreeController",["TT-UI.MultiselectHierarchyTree.Services.TreeNodeFactory","TT-UI.MultiselectHierarchyTree.Services.TreeSelectionRule"]);d.$inject=["$scope","TreeNodeFactory","TreeSelectionRule"],l.controller("MultiselectHierarchyTreeController",d);var l=b.module("TT-UI.MultiselectHierarchyTree.Controllers.MultiselectHierarchyTreeNodeController",[]);e.$inject=[],l.controller("MultiselectHierarchyTreeNodeController",e);var l=b.module("TT-UI.MultiselectHierarchyTree.Directives.MultiselectHierarchyTreeNode",[]);f.$inject=["multiselectHierarchyTreeConfig"],l.directive("multiselectHierarchyTreeNode",f);var l=b.module("TT-UI.MultiselectHierarchyTree.Directives.MultiselectHierarchyTree",[]);g.$inject=["multiselectHierarchyTreeConfig","$timeout"],l.directive("multiselectHierarchyTree",g);var l=b.module("TT-UI.MultiselectHierarchyTree.Directives.TreeBackgroundRows",[]);h.$inject=[],l.directive("treeBackgroundRows",h),b.module("TT-UI.MultiselectHierarchyTree.Filters.TreeNodeFilter",[]).filter("searchNode",i),i.$inject=[],b.module("TT-UI.MultiselectHierarchyTree.Config",[]).constant("multiselectHierarchyTreeConfig",{templatePath:"scripts/multiselect-hierarchy-tree/views/directives/"}),b.module("TT-UI.MultiselectHierarchyTree",["ui.bootstrap.collapse","ngAnimate","TT-UI.MultiselectHierarchyTree.Config","TT-UI.MultiselectHierarchyTree.Services.TreeNodeFactory","TT-UI.MultiselectHierarchyTree.Filters.TreeNodeFilter","TT-UI.MultiselectHierarchyTree.Controllers.MultiselectHierarchyTreeController","TT-UI.MultiselectHierarchyTree.Controllers.MultiselectHierarchyTreeNodeController","TT-UI.MultiselectHierarchyTree.Directives.MultiselectHierarchyTreeNode","TT-UI.MultiselectHierarchyTree.Directives.MultiselectHierarchyTree","TT-UI.MultiselectHierarchyTree.Directives.TreeBackgroundRows"]),b.module("TT-UI.MultiselectHierarchyTree.Services.TreeNodeFactory",[]).constant("TREE_SELECTION_TYPE",{NONE:"none",SELECTED:"selected",INHERIT_SELECTED:"inherit",PARTIAL_SELECTED:"partial"}).factory("TreeNodeFactory",j),j.$inject=["TREE_SELECTION_TYPE"],b.module("TT-UI.MultiselectHierarchyTree.Services.TreeSelectionRule",[]).factory("TreeSelectionRule",k),k.$inject=[]}(window,window.angular);
//# sourceMappingURL=ttui-multiselect-hierarchy-tree.min.js.map