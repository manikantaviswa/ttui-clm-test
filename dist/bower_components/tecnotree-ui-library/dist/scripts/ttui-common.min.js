/*! TT-UI Lib 0.6.24.19 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ttui-common"),function(a,b,c){"use strict";function d(){return{BASE_URL:"scripts/common/"}}function e(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){var e=$(b);e.mask(c.dateInputMaskFormat),e.on("keyup",function(){a.$apply(function(){d.$setViewValue(e.val())})})}}}function f(a,c){return{restrict:"A",require:"ngModel",link:function(d,e,f,g){var h=f.dateFormat||a.DATE_FORMAT;g.$validators.dateValidator=function(a,d){function e(){var a=c.getMoment(),b=h.replace(/y/g,"Y").replace(/d/g,"D");return a(d,b,!0).isValid()}return!!g.$isEmpty(a)||(!!b.isDate(d)||e())}}}}function g(a,d,e,f,g,h){function i(c,d,e){var h=a(e)(g);if(!h)return void f.error('Missing validator: "'+e+'"');var i=a(e+".switch")(g);b.isString(i)?(i=k(c,i),c.$watch("model."+i,function(b){h=b?a(e+'["'+b+'"]')(g):a(e)(g),m(c,d,e,h),d.$$parseAndValidate()})):m(c,d,e,h)}function j(a,b){return b?[a]:a}function k(a,b){return b.replace("arrayIndex",a.arrayIndex)}function l(b,d,e){delete d.$asyncValidators[e],a('form.validationMessage["'+e+'"]').assign(b,c)}function m(c,d,e,h){var i={},j=a("form.validationMessage")(c),k=a("errorMessage")(h);b.isObject(j)?b.extend(i,j):i.default=j;var m,o=a("pattern")(h);return o?(b.isString(o)?(m=a(o+".pattern")(g),k=k||a(o+".errorMessage")(g)):m=o,m?(i[e]=n(k),a("form.validationMessage").assign(c,i),void(d.$validators[e]=function(a,c){return!(!d.$isEmpty(a)&&b.isString(c))||m&&b.isFunction(m.test)&&m.test(c)})):void f.error('Missing validation pattern for: "'+o+'"')):void l(c,d,e)}var n=h;return{restrict:"A",require:"ngModel",link:function(c,d,e,g){var h=a("form.schema.validation")(c);if(h){var k=b.isString(h);if(!k&&!b.isArray(h))return void f.error('Wrong validation type: "'+h+'"');j(h,k).forEach(function(a){i(c,g,a)})}}}}function h(a){a.decorator("sfPath",["$delegate",function(a){var c=a.parse,d=/^[0-9]+$/;return a.parse=function(){var e=c.apply(a,arguments);return e.map(function(a){return b.isString(a)&&a.match(d)?+a:a}),e},a}]),a.decorator("schemaForm",function(a){var b=a.merge;return a.merge=function(a,c,d,e,f){var g=["columns","accordion","columns-inline"];return c=c.map(function(a){var b=[];return g.forEach(function(c){a[c]&&a[c].forEach(function(a){b.push(a)})}),b.length&&(a.items?Array.prototype.push.apply(a.items,b):a.items=b),a}),b.call(this,a,c,d,e,f)},a})}function i(a,c,d,e,f){var g=e.BASE_URL+"views/directives/",h=g+"forms/",i=function(a){var c=a.type;if(b.isArray(c)&&2===c.length){if("null"===c[0])return c[1];if("null"===c[1])return c[0]}return c},j=function(a,b,e){var f=i(b);if(!("string"!==f&&"number"!==f||"date"!==b.format&&"date-time"!==b.format)){var g=c.createStandardForm(a,b,e);return g.key=e.path,g.type="date"===b.format?"datepicker":"datetimepicker",g.dateType=b.dateType,e.lookup[d.stringify(e.path)]=g,g}},k=function(a,c){var d=a.enum,e=b.isArray(d)&&b.isObject(d[0])?l(a,c):m(a,c);return d=a.enum,c.required||-1!==d.indexOf(null)||d.push(null),e},l=function(a){a.masterData=a.enum;var b=a.enum=[],c=a.names={},d=[];return a.masterData.forEach(function(a){d.push({name:a.name,value:a.code}),b.push(a.code),c[a.code]=a.name}),d},m=function(a){var c,d=[],e=a.enum,f=!!b.isObject(a.names)&&a.names;return e.forEach(function(a){null!==a&&(c=f?f[a]:a,d.push({name:c,value:a}))}),d},n=function(a,b,e){var f=i(b),g=b.enum;if("string"===f&&g){var h=c.createStandardForm(a,b,e);return h.key=e.path,h.type="select",h.titleMap=k(b,h),e.lookup[d.stringify(e.path)]=h,h}},o=function(a,b,e){var f=i(b),g=b.items.enum;if("array"===f&&b.items&&g){var h=c.createStandardForm(a,b,e);return h.key=e.path,h.type="checkboxes",h.titleMap=k(b.items,h),e.lookup[d.stringify(e.path)]=h,h}},p=c.defaults;p.string.splice(0,1,j,n),p.number.unshift(j),p.array.splice(0,1,o),c.postProcess(f.wrapper.bind(f)),a.createDecorator("ttuiDecorator",{textarea:h+"textarea.tpl.html",fieldset:h+"tmp.tpl.html",array:h+"array.tpl.html",tabarray:h+"tmp.tpl.html",tabs:h+"tmp.tpl.html",section:h+"section.tpl.html",conditional:h+"section.tpl.html",actions:h+"tmp.tpl.html",select:h+"select.tpl.html",checkbox:h+"tmp.tpl.html",checkboxes:h+"checkboxes.tpl.html",number:h+"default.tpl.html",password:h+"default.tpl.html",submit:h+"submit.tpl.html",button:h+"tmp.tpl.html",radios:h+"radios.tpl.html","radios-inline":h+"radios-inline.tpl.html",radiobuttons:h+"tmp.tpl.html",help:h+"help.tpl.html",default:h+"default.tpl.html",columns:h+"columns.tpl.html","columns-inline":h+"columns-inline.tpl.html",accordion:h+"accordion.tpl.html",break:h+"break.tpl.html",multiselect:h+"multiselect.tpl.html",datepicker:h+"datepicker.tpl.html","validation-status":h+"validation-status.tpl.html","multiselect-dropdown":h+"multiselect-dropdown.tpl.html",typeahead:h+"typeahead.tpl.html","suggestion-box":h+"suggestion-box.tpl.html",static:h+"static.tpl.html"},[]),a.createDirectives({textarea:h+"tmp.tpl.html",select:h+"select.tpl.html",checkbox:h+"tmp.tpl.html",checkboxes:h+"checkboxes.tpl.html",number:h+"default.tpl.html",submit:h+"submit.tpl.html",button:h+"tmp.tpl.html",text:h+"default.tpl.html",date:h+"default.tpl.html",password:h+"default.tpl.html",input:h+"default.tpl.html",radios:h+"tmp.tpl.html","radios-inline":h+"tmp.tpl.html",radiobuttons:h+"tmp.tpl.html",multiselect:h+"multiselect.tpl.html",datepicker:h+"datepicker.tpl.html","multiselect-dropdown":h+"multiselect-dropdown.tpl.html",typeahead:h+"typeahead.tpl.html"})}function j(a,c){c.logic=function(c){return c.forEach(function(c){c.key&&a.registerField(c);var d=(c.schema||{}).type||"",e=(c.schema||{}).format||"";"array"===d&&"table"===e&&(b.isArray(c.items)&&c.items||[]).forEach(function(a){a.notitle=!0})}),c}}function k(){return{restrict:"A",replace:!1,scope:!1,require:"^autoTabForm",link:function(a,b,c,d){a.form.required&&b.attr("tabindex",++d.counter.fields)}}}function l(){return{restrict:"A",replace:!1,scope:!1,require:"^form",controller:["$scope",function(a){var b=this.counter={fields:0,buttons:0};a.$on("$destroy",function(){b.fields=0,b.buttons=0})}]}}function m(){return{restrict:"A",replace:!1,scope:!1,require:"^autoTabForm",link:function(a,b,c,d){var e=d.counter.buttons++;a.$watch(function(){return d.counter.fields},function(){b.attr("tabindex",d.counter.fields+e)})}}}function n(a){return{restict:"A",replace:!1,scope:!1,compile:function(){return{post:function(b,c,d){d.autofocus&&a(function(){c[0].focus()},0)}}}}}function o(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){a.$on("schemaFormValidate",function(){d&&(Object.keys(d.$error).forEach(function(a){d.$setValidity(a,!0)}),d.$$lastCommittedViewValue=Number.NaN)})}}}function p(a,c){return{restrict:"A",scope:!0,priority:-1,require:"?ngModel",link:function(d,e,f){function g(e){c.traverseForm(e,function(c){var f;if(f=h(c))for(var g=i(e),k=0;k<g.length;k++){var l=a(j(c,k));b.isUndefined(l(d.model))&&l.assign(d.model,f)}})}function h(b){return a("default")(b)||a("schema.default")(b)}function i(b){var c=b.key.join(".");return a(c)(d.model)||[]}function j(a,b){return a.key.join(".").replace("..","["+b+"].")}var k=d.$watch(f.sfArray,function(a){a&&(g(a),d.canDeleteFromArray=function(){return!a.schema.hasOwnProperty("minItems")||d.modelArray.length>a.schema.minItems},d.canAppendToArray=function(){return!a.schema.hasOwnProperty("maxItems")||d.modelArray.length<a.schema.maxItems},k())})}}}function q(a,c,d,e){return{restrict:"E",replace:!1,scope:!1,require:"^sfSchema",link:function(f,g,h){var i=h.validator,j=f.arrayIndex,k=a.get(i),l={container:g,title:"",content:"",type:"danger",show:!1},m=d(l),n=[];n.push(c.$on(e.STATUS,function(a,c,d,e,f,g){if(d instanceof k&&d.isInline()&&g===j){if(e||null===e)return void m.hide();var h=[];b.isArray(f)?f.forEach(function(a){b.forEach(a,function(a){h.push(a)})}):b.isString(f)&&h.push(f),b.extend(m.$options,{title:h.join("<br>")}),b.extend(m.$scope,m.$options),m.show()}})),n.push(c.$on(e.IN_PROGRESS,function(a,b,c,d){c instanceof k&&c.isInline()&&d===j&&m.hide()})),f.$on("$destroy",function(){m.hide(),n.forEach(function(a){a()})})}}}function r(a,b){return{restrict:"A",scope:{},compile:function(c,d){var e=d.href,f=d.rtlHref,g=function(){var a=b.getDirection();b.setDocumentDirection(a),"rtl"===a?d.$set("href",f):d.$set("href",e)};return g(),function(b){var c=a.$on("$translateChangeSuccess",g);b.$on("$destroy",function(){c()})}}}}function s(a,d){return{restrict:"E",scope:{events:"=",showEventsMax:"=?",hideLine:"=?",showEndBadge:"=?",showMoreBadge:"=?",badgeSize:"@?",showDateFilter:"=?",filters:"=?",setDefaultDateFilterRange:"=?"},bindToController:!0,controllerAs:"simpleTimelineCtrl",template:'<div class="simple-timeline-ttui"><div class="timeline-filters" ng-if="simpleTimelineCtrl.showDateFilter"><div class="timeline-filters-container"><span class="timeline-filters-item" ng-class="{\'active\':simpleTimelineCtrl.isActive($index)}" ng-repeat="filter in simpleTimelineCtrl.filters" ng-bind="filter.title" ng-click="simpleTimelineCtrl.setFilter(filter, $index)" ng-if="simpleTimelineCtrl.showFilter($index)"></span><span class="timeline-filters-item" ng-click="simpleTimelineCtrl.showAllFilters()" ng-bind="simpleTimelineCtrl.moreFiltersText"></span></div><div class="input-group"><input class="form-control input-prepend" type="text" placeholder="from" name="startTimePicker" data-autoclose="1" ng-model="simpleTimelineCtrl.startTime" bs-datepicker /><span class="input-group-addon"><i class="fa fa-calendar-minus-o fa-lg fa-fw"></i></span><input class="form-control input-append" style="text-align: right;" type="text" placeholder="to" name="endTimePicker" data-autoclose="1" ng-model="simpleTimelineCtrl.endTime" bs-datepicker /></div></div><ul class="fa-ul" ng-class="{\'no-line\':simpleTimelineCtrl.hideLine}"><li ng-repeat="event in simpleTimelineCtrl.events | timelineRangeFilter:simpleTimelineCtrl | timelineContentFilter:simpleTimelineCtrl | timelineOrderByFilter" ng-switch on="event.type" ng-if="simpleTimelineCtrl.showEvent($index)" ng-click="simpleTimelineCtrl.action(event)" ng-class="{\'no-bubble\':event.type === \'button\'}"><i ng-class="event.status"><i class="fa-li" ng-class="[simpleTimelineCtrl.getBadgeIconClass(event), simpleTimelineCtrl.getBadgeSizeClass()]"></i></i><div ng-class-even="\'timeline-panel-inverse\'" ng-class-odd="\'timeline-panel\'"><div ng-switch-default><div class="time" ng-bind="event.time | date:\'mediumDate\'"></div><div class="header" ng-bind="event.title"></div></div><div ng-switch-when="image"><div class="time" ng-bind="event.time | date:\'mediumDate\'"></div><div class="header" ng-bind="event.title"></div><img ng-src="{{event.src}}" class=""></img></div><div ng-switch-when="button"><button class="btn btn-primary" type="button">{{event.title}}</button></div><div ng-class="{\'content\': !event.type, \'content-btn\': event.type === \'button\', \'content-img\': event.type === \'image\'}" ng-bind="event.content"></div></div></li><li ng-if="simpleTimelineCtrl.filteredEventsLength > 0 && simpleTimelineCtrl.showEndBadge"><i class="primary"><i class="fa-li fa fa-circle" ng-class="[simpleTimelineCtrl.getBadgeSizeClass()]"></i></i><div>&nbsp;</div></li><li ng-if="simpleTimelineCtrl.filteredEventsLength > 0 && simpleTimelineCtrl.showMoreBadgeFn()"><i class="primary" ng-click="simpleTimelineCtrl.showAll()" data-role="more-click"><i class="fa-li fa" ng-class="[simpleTimelineCtrl.getMoreClass(), simpleTimelineCtrl.getBadgeSizeClass()]"></i></i><div class="content-more-badge">&nbsp;</div></li></ul><div class="timeline-filters" ng-if="simpleTimelineCtrl.filteredEventsLength === 0">No results</div></div>',controller:function(){var a=!1,e=function(){var a=new Date,b=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()+1,0);this.startTime=b,this.endTime=c}.bind(this);(!b.isDefined(this.showEventsMax)||this.showEventsMax<0)&&(this.showEventsMax=-1),!0===this.setDefaultDateFilterRange&&e(),this.showAllEventsToggle=!1,this.showEventsMaxOriginal=this.showEventsMax,this.visibleFiltersMax=3,this.visibleFiltersMaxOriginal=this.visibleFiltersMax,this.moreFiltersText="More...",this.action=function(a){d(a.action)(a)},this.showEvent=function(a){return a<this.showEventsMax||this.showEventsMax<0},this.showDownArrow=function(){return this.filteredEventsLength>this.showEventsMax&&this.showEventsMax>0},this.showAll=function(){this.showAllEventsToggle=!this.showAllEventsToggle,this.showAllEventsToggle?this.showEventsMax=-1:this.showEventsMax=this.showEventsMaxOriginal},this.showMoreBadgeFn=function(){return this.showMoreBadge&&this.filteredEventsLength>this.showEventsMaxOriginal&&this.showEventsMaxOriginal>0},this.showFilter=function(a){return a<this.visibleFiltersMaxOriginal||this.visibleFiltersMax<0},this.showAllFilters=function(){a=!a,a?(this.visibleFiltersMax=-1,this.moreFiltersText="Less..."):(this.visibleFiltersMax=this.visibleFiltersMaxOriginal,this.moreFiltersText="More...")},this.activeFilterIndex=c,this.setFilter=function(a,b){this.filter=a,this.activeFilterIndex=b},this.isActive=function(a){return a===this.activeFilterIndex},this.getBadgeIconClass=function(a){return a.badgeIconClass},this.getBadgeSizeClass=function(){if(this.badgeSize)return this.badgeSize+"-badge"},this.getMoreClass=function(){var a="";return this.showDownArrow()?a+="fa-arrow-circle-o-down":a+="fa-arrow-circle-o-up",a}}}}function t(){return function(a,c,d){var e=[];return c=(c||"").toLowerCase(),b.forEach(a,function(a){var b=a[d];b&&(b=(""+b).toLowerCase(),b.indexOf(c)>=0&&e.push(a))}),e}}function u(){function a(a){return a.replace(b,c)}var b=/[\.\?\*\+\^\$\[\]\\(\)\{\}\|\-]/g,c="\\$&";return a}function v(a,b){this.putJsonDeferred=function(c,d){var e=b.defer();return a.put(c,d).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},this.loadJsonDeferred=function(c){var d=b.defer();return a.get(c).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},this.postJsonDeferred=function(c,d){var e=b.defer();return a.post(c,d).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise}}function w(a,b,c,d){function e(){g.resolve(),k.hide()}function f(){g.reject(),k.hide()}var g,h=d,i={title:"Confirmation request",content:"Please confirm",namespace:"panel-dialog",buttons:[{name:"Confirm",action:e},{name:"Cancel",action:f}]},j=!1,k=c();a.$on("$stateChangeStart",function(){if(j)return void(j=!1)}),this.confirm=function(a,c,d,f,l){j=f,g=b.defer();var m;return"ok"===d&&(m=[{name:h("Ok"),action:e}]),k.show({title:c||h(i.title),content:a||h(i.message),buttons:m||i.buttons,namespace:l||i.namespace}),k.on(".hide",function(){g.reject()}),g.promise},this.hide=function(){k.hide()}}function x(a,c){var d=function(a){if(a){var b=a.indexOf("[]");if(b>=0)return{arrayPath:a.substring(0,b),remainingPath:a.substring(b+2)}}},e=function(a){return!!d(a)},f=function(a,d){return!b.isUndefined(c(d)(a))},g=function(a,b){return a+"["+b+"]"},h=function(b,e,h,i,k,l){var m,n=[],o=d(e),p=d(i);if(p){var q=c(h+o.arrayPath)(b);if(q)for(m=0;m<q.length;m++){var r=h+g(o.arrayPath,m),s=k+g(p.arrayPath,m),t=[];f(b,r)&&(t=j(b,o.remainingPath,r,p.remainingPath,s,l)),n=n.concat(t)}}else a.error("Unsupported array mapping",[].slice.call(arguments));return n},i=function(b,c,d,e,g,h){var i=[],j=d+c,k=g+e;return h||f(b,j)?i.push({sourcePath:j,targetPath:k}):a.debug("Problems with mapping, possible missing value",[].slice.call(arguments)),i},j=function(a,b,c,d,f,g){return g=!!g,e(b)?h(a,b,c,d,f,g):i(a,b,c,d,f,g)};return{extractFields:function(a,b,c,d){return j(a,b,"",c,"",d)}}}function y(a,b,c){function d(a){return a?b.loadJsonDeferred(a):null}var e=function(a,b,c){this._schemaUrl=a,this._structureUrl=b,this._optionsUrl=c,this._mappings=[],this._dictionaries=[],this._model={}};return e.prototype._loadForm=function(){return a.all([this._getSchema(),this._getStructure(),this._getOptions()])},e.prototype._getStructure=function(){return d(this._structureUrl)},e.prototype._getSchema=function(){return d(this._schemaUrl)},e.prototype._getOptions=function(){return d(this._optionsUrl)},e.prototype.addCopyMappings=function(a,b){return this._mappings.push({uri:a,model:b}),this},e.prototype.addDictionary=function(a,b){return this._dictionaries.push({mappings:a,masterData:b}),this},e.prototype._runDictionaries=function(a){return this._dictionaries.forEach(function(b){c.populateSchemaWithMasterData(a.schema,b.masterData,b.mappings)}),a},e.prototype._copyMappings=function(d){function e(a,b){var e=f[b].model;c.copyValuesFrom(a,e,d.model)}var f=this._mappings,g=f.map(function(a){return a.uri}).map(b.loadJsonDeferred);return a.all(g).then(function(a){return a.forEach(e),d})},e.prototype.getForm=function(b){function c(a,c,d){return{schema:a,structure:c,options:d,model:b||{}}}return this._loadForm().then(a.spread(c)).then(this._runDictionaries.bind(this)).then(this._copyMappings.bind(this))},e}function z(a,c,d,e,f,g){function h(){this.modal=d(j)}function i(c){return b.isString(c.title)?!b.isUndefined(c.content)||!b.isUndefined(c.contentUrl)||(a.error("Content should be provided: "+c.content+"; "+c.contentUrl),!1):(a.error("Title should be a string, but got: "+c.title),!1)}var j={prefixEvent:g.EVENT_PREFIX,templateUrl:f.BASE_URL+"views/modal-panel-dialog.tpl.html",show:!1};return h.prototype.show=function(a){if(i(a)){var c=function(c){if(b.isString(c))return e("<div ng-include=\"'"+c+"'\"></div>")(a.scope||this.modal.$scope)}.bind(this);return b.extend(this.modal.$options,{title:a.title,content:c(a.contentUrl)||a.content,buttons:a.buttons||this.modal.$options.buttons,footer:c(a.footerUrl),namespace:a.namespace||this.modal.$options.namespace}),b.extend(this.modal.$scope,this.modal.$options),this.modal.$promise.then(this.modal.show.bind(this))}},h.prototype.hide=function(){this.modal.hide()},h.prototype.on=function(a,b){this.modal.$scope.$on(g.EVENT_PREFIX+a,b)},function(){return new h}}function A(a,b,c){function d(){if(a.LOCALE_LIST){var c=b.proposedLanguage()||a.LOCALE_DEFAULT;return a.LOCALE_LIST[c].dir}}var e={};return e.getDirection=function(){return d()},e.setDocumentDirection=function(a){c[0].dir=a||""},e.isCurrentLanguageRtl=function(){return"rtl"===d()},e}function B(a,c,d,e,f){var g=e,h=function(a,c){return a.replace(/\[\]/g,"["+(b.isNumber(c)?c:0)+"]")},i=function(a,b,c){this._ruleName=a,this._name=b||a,this._inline=!!c,this._schema=[],this._formModel=null,this._model=null,this._reportConfig=null,this._isFormNotification=!1};return i.prototype.getRuleName=function(){return this._ruleName},i.prototype.getName=function(){return this._name},i.prototype.isInline=function(){return this._inline},i.prototype.setSchema=function(a){return this._schema=a,this},i.prototype.getSchema=function(){return this._schema},i.prototype.setFormNotification=function(a){return this._isFormNotification=a,this},i.prototype.setForm=function(a){return this._formModel=a,this},i.prototype.getForm=function(){return this._formModel},i.prototype.setModel=function(a){return this._model=a,this},i.prototype.getModel=function(){return this._model},i.prototype.setReportConfig=function(a){return this._reportConfig=a,this},i.prototype.getReportConfig=function(){return this._reportConfig},i.prototype._canPopulateModel=function(){return b.isObject(this.getModel())&&b.isObject(this.getReportConfig())},i.prototype.populateModelWithValidationResult=function(a,d){if(this._canPopulateModel()&&b.isObject(a)){var e=this.getReportConfig(),g=this.getModel(),i=function(a){return"boolean"==typeof a?a?"PASSED":"FAILED":a};b.isNumber(d)||(d=0),b.forEach(e,function(b,e){var j=h(e,d);f.fixArrayParse(j,g),c(j).assign(g,i(c(b)(a)))})}},i.prototype._getLocalData=function(a){return a},i.prototype._collectData=function(a){var d=this.getModel(),e=this._getLocalData(a),f={};return b.forEach(this.getSchema(),function(a,b){var g="";a&&(g=c(a)(d,e)),c(b).assign(f,g?g.toString():"")}),f},i.prototype._collectArrayData=function(a,d){var e=this.getModel(),f=this._getLocalData(d),g={};return b.forEach(this.getSchema(),function(b,d){var i="";b&&(i=c(h(b,a))(e,f)),c(d).assign(g,i?i.toString():"")}),g},i.prototype._hasValues=function(a){return Object.keys(a).every(function(c){var d=a[c];return b.isObject(d)?this._hasValues(d):d},this)},i.prototype._getMissingValues=function(a){var c,d=[];return Object.keys(a).forEach(function(e){c=a[e],b.isObject(c)?d.push.apply(d,this._getMissingValues(c)):c||d.push(e)},this),d},i.prototype._resolver=function(b,c){return a.when({status:b,message:c})},i.prototype._rejector=function(b,c){return a.reject({status:b,message:c})},i.prototype._apiSuccessResolver=function(a){var b=this._isResponseValid(a),c=this._getResponseMessage(a);return this._resolver(b,c)},i.prototype._apiFailureResolver=function(){return this._rejector(!1,g("API failed"))},i.prototype._missingValuesResolver=function(a){return d.error("Missing validator values",this.getName(),a),this._rejector(null,g("Missing values ({{valuesNum}})",{valuesNum:a.length}))},i.prototype.notifyForm=function(a){this._isFormNotification&&this._formModel&&this._formModel.$setValidity(this._ruleName,a||!1)},i.prototype._isResponseValid=function(){throw new Error("isResponseValid method was not implemented yet")},i.prototype._getResponseMessage=function(){throw new Error("getResponseMessage method was not implemented yet")},i.prototype._buildRequest=function(){throw new Error("buildRequest method was not implemented yet")},i.prototype.validate=function(){throw new Error("Validate method was not implemented yet")},i}function C(){var a={"clm-phone-number":/^(\+\d{1,4}[ \-]?)?[\d\- ]{6,12}$/,"clm-email":/^((?:(?:(?:[a-zA-Z0-9][\.\-\+_]?)*)[a-zA-Z0-9])+)\@((?:(?:(?:[a-zA-Z0-9][\.\-_]?){0,62})[a-zA-Z0-9])+)\.([a-zA-Z0-9]{2,6})$/};Object.keys(a).forEach(function(b){var c=a[b];c instanceof RegExp||(c=new RegExp(c)),tv4.addFormat(b,function(a){if(a&&!c.test(a))return"Format error"})})}!function(){function a(){var a="";return this===Function||this===Function.prototype.constructor?a="Function":this!==Function.prototype&&(a=(""+this).replace(b,"").replace(c,"")),a}var b=/^[\S\s]*?function\s*/,c=/[\s\(\/][\S\s]+$/,d=!("name"in Function.prototype&&"name"in function(){}),e="function"==typeof Object.defineProperty&&function(){var a;try{Object.defineProperty(Function.prototype,"_xyz",{get:function(){return"blah"},configurable:!0}),a="blah"===Function.prototype._xyz,delete Function.prototype._xyz}catch(b){a=!1}return a}();Function.prototype._name=a,e&&d&&Object.defineProperty(Function.prototype,"name",{get:a})}(),b.module("TT-UI.Common.AngularStrap",["ngAnimate","mgcrea.ngStrap.affix","mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.alert","mgcrea.ngStrap.modal","mgcrea.ngStrap.datepicker","mgcrea.ngStrap.tab","TT-UI.Config","TT-UI.Common.Config","TT-UI.Common.Translate","TT-UI.Common.Filters.DateFilter","TT-UI.Common.Filters.IsArrayFilter","TT-UI.Common.MomentProvider"]).config(function(a,c){a.decorator("datepickerViews",function(a,d,e,f){function g(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c}function h(a,b){function h(a,b){return(a%b+b)%b}function i(){return/^jD+/.test(l.dayFormat)}var j=c.getMoment(),k=a.$scope,l=a.$options,m=l.lang,n=function(a,b){return d.formatDate(a,b,m)},o=f({format:l.dateFormat,lang:m,strict:l.strictFormat}),p=d.weekdaysShort(m);if(i()){l.startWeek=-1;var q=["Yek","Dos","Seh","Che","Pan","Jom","Sha"];p="fa"!==m?q:p}var r=p.slice(l.startWeek).concat(p.slice(0,l.startWeek)),s=e.trustAsHtml('<th class="dow text-center">'+r.join('</th><th class="dow text-center">')+"</th>");return function(){function d(a){return i()?j([b.year,b.month,b.date]).jMonth()!==j(a).jMonth():a.getMonth()!==b.month}var e=new Date(b.year,b.month,1);i()&&(j=c.getMoment(),e=j([b.year,b.month,b.date]).startOf("jMonth").toDate());var f=e.getTimezoneOffset(),m=new Date(+e-864e5*h(e.getDay()-l.startWeek,7)),p=m.getTimezoneOffset(),q=o.timezoneOffsetAdjust(new Date,l.timezone).toDateString();p!==f&&(m=new Date(+m+6e4*(p-f)));for(var r,t=[],u=0;u<42;u++)r=o.daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth(),m.getDate()+u)),t.push({date:r,isToday:r.toDateString()===q,label:n(r,this.format),selected:a.$date&&this.isSelected(r),muted:d(r),disabled:this.isDisabled(r)});k.title=n(e,l.monthTitleFormat),k.showLabels=!0,k.labels=s,k.rows=g(t,this.split),this.built=!0}}function i(a,b){var e=a.$scope,f=a.$options,h=f.lang,i=function(a,b){return d.formatDate(a,b,h)};return function(){var d=b.year-b.year%(3*this.split),h=c.getMoment(),j=/^jY+/.test(f.yearFormat);j&&(d=h([d,b.month,b.date]).year());for(var k,l=[],m=0;m<12;m++)k=new Date(d+m,0,1),j&&(k=h([d+m,b.month,b.date]).startOf("jYear").toDate()),l.push({date:k,label:i(k,this.format),selected:a.$isSelected(k),disabled:this.isDisabled(k)});e.title=l[0].label+"-"+l[l.length-1].label,e.showLabels=!1,e.rows=g(l,this.split),this.built=!0}}function j(a,b){var e=c.getMoment(),f=a.$scope,h=a.$options,i=h.lang,j=function(a,b){return d.formatDate(a,b,i)};return function(){for(var c,d=/^jM+$/.test(h.monthFormat),i=[],k=0;k<12;k++){if(d){c=e([b.year+1,0]).jMonth(k).toDate()}else c=new Date(b.year,k,1);i.push({date:c,label:j(c,this.format),selected:a.$isSelected(c),disabled:this.isDisabled(c)})}f.title=j(c,h.yearTitleFormat),f.showLabels=!1,f.rows=g(i,this.split),this.built=!0}}function k(c){var d=a(c),e=[{build:h(c,d.viewDate)},{build:j(c,d.viewDate)},{build:i(c,d.viewDate)}],f=c.$options.minView;return e=f?e.slice(f):e,b.merge(d.views,e),d}return k})}).config(["$provide","momentProvider",function(a,c){var d=c.getMoment();a.decorator("$dateParser",["$delegate","$log","CONFIG",function(a,c,e){function f(){return new Date(e.MIN_YEAR_OF_BIRTH,0)}var g=function(a,c,e){return e=e||this.$format,e=e.replace(/'([^']+)'/g,"$1"),(b.isDate(a)?d(a):d(a,e)).toDate()};return function(){var b=a.apply(a,arguments);return b.parse=g,b.getDateForAttribute=function(a){return function(b,c){return"minYearOfBirth"===c?f():a(b,c)}}(b.getDateForAttribute),b}}])}]).config(["$modalProvider","$alertProvider","$datepickerProvider","$provide","CONFIG","COMMON_CONFIG",function(a,c,d,e,f,g){var h=g.BASE_URL+"views/angular-strap/";b.extend(c.defaults,{animation:"am-fade-and-slide-top",dismissable:!1,duration:3,keyboard:!1,template:h+"alert.tpl.html"}),b.extend(a.defaults,{animation:"am-fade-and-scale",placement:"center",container:"body",backdrop:"static",keyboard:!1}),e.decorator("$datepicker",function(a,c,d){function e(){var d=f.DATE_PICKER_LOCALE_DATE_FORMAT||f.LOCALE_DEFAULT,e=c.use()||f.LOCALE_DEFAULT,i=b.extend({},h.datePicker,b.copy(f.LOCALE_LIST[d].datePicker)),j=f.LOCALE_LIST[e]||h;i.modelDateFormat=f.MODEL_DATE_FORMAT,i.lang=j.lang,i.dir=j.dir,b.extend(a.defaults,g,i)}var g={dateType:"string",startWeek:1},h=b.copy(f.LOCALE_DEFAULT_SETTINGS);return e(),d.$on("$translateChangeEnd",e),a})}]).config(function(a,b){var c=b.getMoment();a.decorator("$dateFormatter",function(a,b,d){function e(a){return c.localeData(a)?a:b.LOCALE_DEFAULT}return"function"==typeof c.loadPersian&&c.loadPersian(),a.getDefaultLocale=function(){return d.proposedLanguage()||b.LOCALE_DEFAULT},a.formatDate=function(b,d,f){return d=a.getDatetimeFormat(d,f),c(b).locale(e(f)).format(d)},a.weekdaysShort=function(a){return c.localeData(e(a))._weekdaysShort},a.getDatetimeFormat=function(a,b){var d;return"shortDate"===a?d="L":"shortTime"===a&&(d="LT"),d?c.localeData(e(b))._longDateFormat[d]||a:a},a})});var D=b.module("TT-UI.Common.Config",[]);D.constant(d.name,d()),b.module("TT-UI.Common.Directives",["TT-UI.Common.Config","TT-UI.Common.Directives.ActionLinks","TT-UI.Common.Directives.Breadcrumbs","TT-UI.Common.Directives.Forms","TT-UI.Common.Directives.NavMenu","TT-UI.Common.Directives.MultiselectDropdown","TT-UI.Common.Directives.MultiselectDropdownLegacy","TT-UI.Common.Directives.Pagination","TT-UI.Common.Directives.PostMessage","TT-UI.Common.Directives.ProgressBar","TT-UI.Common.Directives.RouteLabel","TT-UI.Common.Directives.Select","TT-UI.Common.Directives.Sortable","TT-UI.Common.Directives.Spinner","TT-UI.Common.Directives.SpinnerInside","TT-UI.Common.Directives.Tabs","TT-UI.Common.Directives.Toggle","TT-UI.Common.Directives.AutoFormatDate","TT-UI.Common.Directives.AutoFocus","TT-UI.Common.Directives.DateValidator","TT-UI.Common.Directives.DateInputMask","TT-UI.Common.Directives.FieldValidator","TT-UI.Common.Directives.BootstrapUiTmplates","TT-UI.Common.Directives.ChargesTable","TT-UI.Common.Directives.RtlHref","TT-UI.Common.Directives.SimpleTimeline"]).value("VIEW_CONFIG",["COMMON_CONFIG",function(a){return{URL:a.BASE_URL+"/views/",DIRECTIVE_URL:a.BASE_URL+"/views/directives/"}}]),b.module("TT-UI.Common.Directives.ActionLinks",["TT-UI.Common.States"]).directive("actionLinks",function(){return{restrict:"E",replace:!0,transclude:!0,scope:!0,controller:["$scope","$state","$stateParams",function(a,b,c){a.links=[],a.params={};var d=a.$on("$stateChangeSuccess",function(){a.links.length=0;for(var c=b.$current;c.parent&&-1!==c.name.indexOf(".");)c=c.parent;c&&c.children&&c.children.forEach(function(b){b.url&&b.label&&!b.ownParams.length&&!b.aside&&a.links.push(b)})});a.params=c,a.$on("$destroy",d)}],template:'<ul class="shortcuts"><li ng-repeat="state in links"><a href="{{state.url.format(params)}}" ui-sref="{{state.name}}({{params}})" data-action="{{state.data.action}}" ng-bind="state.label"></a></li></ul>'}}),b.module("TT-UI.Common.Directives.AutoFormatDate",["TT-UI.Config"]).constant("FORMAT_CONFIG",{SEPARATOR_PATTERN:/[^a-zA-Z0-9]/}).directive("autoFormatDate",["$timeout","CONFIG","FORMAT_CONFIG",function(a,b,c){return{restrict:"A",link:function(d,e,f){var g,h,i=f.$observe("autoFormatDate",function(a){g=""!==a?a:b.DATE_FORMAT,i()}),j=function(){if(g){var a=e.val(),b=a.length;b<g.length&&c.SEPARATOR_PATTERN.test(g[b])&&e.val(a+g[b])}},k=function(){h=a(j,0)};e.on("keypress",k),d.$on("$destroy",function(){a.cancel(h),e.off("keypress",k)})}}}]),b.module("TT-UI.Common.Directives.AutoFocus",[]).directive("autofocus",["$timeout",function(a){return{restrict:"A",link:{pre:function(b,c,d){d.autofocus&&a(function(){c[0].focus()})}}}}]),b.module("TT-UI.Common.Directives.BootstrapUiTmplates",["TT-UI.Common.Config","ui.bootstrap.dropdown"]).run(["$http","$templateCache","COMMON_CONFIG",function(a,b,c){var d=c.BASE_URL+"views/directives/";[{path:d+"bootstrap/accordion/accordion.tpl.html",bootstrapPath:"uib/template/accordion/accordion.html"},{path:d+"bootstrap/accordion/accordion-group.tpl.html",bootstrapPath:"uib/template/accordion/accordion-group.html"}].forEach(function(c){a.get(c.path,{cache:b}).then(function(a){b.put(c.bootstrapPath,a.data)})})}]),b.module("TT-UI.Common.Directives.Breadcrumbs",["ui.router"]).directive("breadcrumbs",function(){return{restrict:"E",replace:!0,transclude:!0,scope:!0,controller:["$scope","$state","$stateParams",function(a,b,c){a.path=[],a.params=c,a.goTo=function(a){b.go(a.name,c,{reload:!0})};var d=a.$on("$stateChangeSuccess",function(){a.path.length=0,b.$current.path.some(function(b){if(!b.url||!b.label||b.modal||b.aside)return!0;a.path.push(b)})});a.$on("$destroy",d)}],template:'<ul class="breadcrumbs"><li ng-repeat="state in path"><a href="#{{state.url.format(params)}}" ng-click="goTo(state); $event.preventDefault()" ng-bind="state.label"></a></li></ul>'}}),b.module("TT-UI.Common.Directives.ChargesTable",["smart-table"]).directive("chargesTable",["$translate","$filter","translateFilter",function(a,c,d){function e(a){function e(a,b){var d="currencySymbols.",e="";if(a)return b?(d+=b,e=g(d),d===e?c("currency")(a):c("currency")(a,e)):c("currency")(a)}var f,g=d,h=b.copy(a.payments),i=0,j=0;b.isArray(h)||(h=[h]),a.monthlyPayments=[],a.oneTimePayments=[],a.formatPrice=e,b.forEach(h,function(b){a.monthlyPayments.push(b.getMonthlyPayments()),a.oneTimePayments.push(b.getOneTimePayments()),i+=b.getTotalNetMonthly(),j+=b.getTotalNetOnetime(),b.payment&&b.payment.currency&&(f=b.payment.currency)}),a.totalCurrencySymbol=f,a.monthlyPayments=[].concat.apply([],a.monthlyPayments),a.oneTimePayments=[].concat.apply([],a.oneTimePayments),
a.totalNetMounthly=Math.round(100*i)/100,a.totalNetOnetime=Math.round(100*j)/100,b.forEach(a.monthlyPayments.concat(a.oneTimePayments),function(a){a.amount=Math.round(100*a.amount)/100,a.netAmount=Math.round(100*a.netAmount)/100})}return{require:"?ngModel",restrict:"E",scope:{payments:"="},link:function(a){a.payments&&a.$watch("payments",function(){e(a)})},replace:!0,template:'<div><table class="table table-data-ttui"><thead><tr><th translate="Description">Description</th><th translate="Type">Type</th><th translate="Periodicity">Periodicity</th><th translate="Tax">Tax</th><th translate="Amount">Amount</th><th translate="Net Amount">Net Amount</th><th translate="Amount">Amount</th><th translate="Net Amount">Net Amount</th></tr></thead><tbody><tr ng-repeat="payment in monthlyPayments"><td>{{ payment.commercialArticleName || payment.commercialArticle }}</td><td>{{ payment.chargeType }}</td><td>Monthly</td><td  class="format-price">{{ formatPrice(1, totalCurrencySymbol) }}</td><td  class="format-price">{{ formatPrice(payment.amount, totalCurrencySymbol) }}</td><td><strong  class="format-price">{{ formatPrice(payment.netAmount, totalCurrencySymbol) }}</strong><br/><small>-{{ payment.discountPercentage*100 | number: 0 }}%</small></td><td>-</td><td>-</td></tr><tr ng-repeat="payment in oneTimePayments"><td>{{ payment.commercialArticleName || payment.commercialArticle }}</td><td>{{ payment.chargeType }}</td><td>One Time</td><td  class="format-price">{{ formatPrice(payment.taxRate, totalCurrencySymbol) }}</td><td>-</td><td>-</td><td  class="format-price">{{ formatPrice(payment.amount, totalCurrencySymbol) }}</td><td><strong  class="format-price">{{ formatPrice(payment.netAmount, totalCurrencySymbol) }}</strong><br/><small>-{{ payment.discountPercentage*100 | number: 0 }}%</small></td></tr><tr><td></td><td></td><td></td><td><strong translate="TOTAL inc. TAX">TOTAL inc. TAX</strong><br></td><td></td><td><strong  class="format-price">{{ formatPrice(totalNetMounthly, totalCurrencySymbol) }}</strong><br><small translate="Monthly Charge">Monthly Charge</small></td><td></td><td><strong  class="format-price">{{ formatPrice(totalNetOnetime, totalCurrencySymbol) }}</strong><br><small translate="Pay Upfront">Pay Upfront</small></td></tr></tbody></table></div>'}}]);var D=b.module("TT-UI.Common.Directives.DateInputMask",[]);D.directive("dateInputMask",e);var D=b.module("TT-UI.Common.Directives.DateValidator",["TT-UI.Config","TT-UI.Common.AngularStrap"]);f.$inject=["CONFIG","moment"],D.directive("dateValidator",f);var D=b.module("TT-UI.Common.Directives.FieldValidator",["TT-UI.FieldValidator.Config","TT-UI.Common.Translate"]);g.$inject=["$parse","$q","$timeout","$log","FIELD_VALIDATOR_CONFIG","translateFilter"],D.directive("fieldValidator",g);var D=b.module("TT-UI.Common.Directives.Forms",["schemaForm","ui.bootstrap.accordion","ui.bootstrap.typeahead","uib/template/typeahead/typeahead-match.html","uib/template/typeahead/typeahead-popup.html","ngAnimate","TT-UI.Common.AngularStrap","TT-UI.Common.Config","TT-UI.Common.Services.FormValidator","TT-UI.Common.Directives.BootstrapUiTmplates","TT-UI.Common.Filters.ObjectFieldFilter"]);D.constant("SCHEMA_FORM_PREPROCESSOR",{wrapper:function(a){return this.logic(a)}}),D.config(h),D.config(i),D.run(j),h.$inject=["$provide"],i.$inject=["schemaFormDecoratorsProvider","schemaFormProvider","sfPathProvider","COMMON_CONFIG","SCHEMA_FORM_PREPROCESSOR"],j.$inject=["FormValidator","SCHEMA_FORM_PREPROCESSOR"];var D=b.module("TT-UI.Common.Directives.Forms");D.directive(k.name,k);var D=b.module("TT-UI.Common.Directives.Forms");D.directive(l.name,l);var D=b.module("TT-UI.Common.Directives.Forms");D.directive(m.name,m);var D=b.module("TT-UI.Common.Directives.Forms");n.$inject=["$timeout"],D.directive(n.name,n);var D=b.module("TT-UI.Common.Directives.Forms");D.directive(o.name,o);var D=b.module("TT-UI.Common.Directives.Forms");p.$inject=["$parse","schemaForm"],D.directive(p.name,p);var D=b.module("TT-UI.Common.Directives.Forms");q.$inject=["$injector","$rootScope","$alert","VALIDATION_EVENTS"],D.directive(q.name,q),b.module("TT-UI.Common.Directives.IsDateAfterValidator",["TT-UI.Config","TT-UI.Common.AngularStrap","TT-UI.Common.AngularStrap","TT-UI.Common.Services.FormValidator"]).directive("isDateAfterValidator",["$dateParser","$log","CONFIG",function(a,b,c){var d=a({format:c.MODEL_DATE_FORMAT});return{restrict:"A",require:["?ngModel","^form"],link:function(a,c,e,f){if(e.isDateAfterValidator){var g=f[0],h=f[1],i=e.isDateAfterValidator,j=h[i];a.$watch(function(){return j.$modelValue},g.$validate),g.$validators.shouldBeAfter=function(a){if(!a)return!0;var c=d.parse(j.$modelValue),e=d.parse(a);if(!c||!e)return b.error("Date format exception (is-date-after-validator): one of dates is not in correct format. "+c+" "+e),!1;var f=c.getTime();return e.getTime()>=f}}}}}]),b.module("TT-UI.Common.Directives.MultiselectDropdownLegacy",[]).directive("multiselectDropdownLegacy",function(){return{require:"ngModel",restrict:"E",scope:{options:"=",preselected:"="},replace:!0,link:function(a,d,e,f){function g(){var c=a.model,d=b.copy(c);f.$setViewValue(d),h(c)}function h(c){if(b.isUndefined(c))a.selectedDescription="";else{var d=c.map(function(b){var c;return a.options.some(function(a){if(a.value===b)return c=a.name}),c||b});a.selectedDescription=d.length>4?d.length+" items selected":d.join(", ")}return c}function i(b){return function(){a.open||(a.open=!0);var c=j(a.options,"value");if(""===n)return void(n=c[0]);var d=c.indexOf(n);n=d+b>c.length-1?c[0]:d+b<0?c[c.length-1]:c[d+b]}}function j(a,b){var d,e=[];for(d in a)a.hasOwnProperty(d)&&a[d][b]!==c&&e.push(a[d][b]);return e}function k(a,b){return-1!==a.indexOf(b)}function l(a,b){var c=a.indexOf(b);return-1!==c&&a.splice(c,1),a}var m=d[0],n="";a.selectedDescription="",a.model=a.preselected||[],0!==a.model.length&&(g(),f.$setPristine()),f.$formatters.push(h),f.$parsers.push(h),$(m).click(function(b){$(b.target).hasClass("ui-multiselect-dropdown-option")||e.disabled||(a.open=!a.open,a.$digest())}),a.selectAll=function(){a.model=j(a.options,"value"),g()},a.deselectAll=function(){a.model.length=0,g()},a.setSelectedItem=function(b){var c=b.value;return k(a.model,c)?a.model=l(a.model,c):a.model.push(c),n=c,g(),!1},a.isChecked=function(b){return k(a.model,b)},a.keyBoardPointer=function(a){return n===a};var o={32:{name:"space",preventDefault:!0},13:{name:"space",preventDefault:!0},38:{name:"arrowUp",preventDefault:!0},40:{name:"arrowDown",preventDefault:!0},27:{name:"escape",preventDefault:!1}},p={space:function(){a.open&&""!==n?""!==n&&a.setSelectedItem({value:n}):a.open=!0},arrowUp:i(-1),arrowDown:i(1),escape:function(){a.open=!1,n="",a.$digest()}};$(m).keydown(function(b){if(!e.disabled){var c=o[b.keyCode];c&&(c.preventDefault&&b.preventDefault(),p[c.name](),a.$digest())}}),$(m).focusout(function(){p.escape()})},template:'<div tabindex="0" class="btn-group ui-multiselect-dropdown" ng-class="{open: open}" ng-init="open=false" data-role="multiselect"><div class="ui-multiselect-dropdown-description" ng-bind="selectedDescription || \'Select\'"></div><ul class="dropdown-menu" autofocus="autofocus"><li ng-click="selectAll()" class="ui-multiselect-dropdown-option" data-role="option" data-value="select-all">Check All</li><li ng-click="deselectAll();" class="ui-multiselect-dropdown-option" data-role="option" data-value="unselect-all">Uncheck All</li><li class="divider"></li><li ng-repeat="option in options" ng-click="setSelectedItem(option)" class="ui-multiselect-dropdown-option" ng-class="{selected: keyBoardPointer(option.value)}" data-role="option" ng-attr-data-value="{{::option.value}}" data-type="value" ng-attr-data-checked="{{isChecked(option.value) ? 1 : 0}}">{{::option.name}}<span ng-class="{\'glyphicon glyphicon-ok pull-right\': isChecked(option.value)}"></span></li></ul></div>'}}),b.module("TT-UI.Common.Directives.MultiselectDropdown",["ngAnimate"]).directive("multiselectDropdown",function(a){return{require:"ngModel",restrict:"E",scope:{options:"=",preselected:"=?",saveValueOnly:"=?",ngModel:"=",isDisabled:"=?"},link:function(c,d,e,f){function g(){var a=f.$viewValue;return b.isUndefined(a)?c.selectedOptions=[]:c.saveValueOnly?c.selectedOptions=h(a):c.selectedOptions=a,a}function h(a){var d=[];return b.forEach(a,function(a){var b=p(c.options,a);b&&d.push({name:b.name,value:b.value})}),d}function i(a){var d=[];return b.forEach(a,function(a){var b=p(c.options,a.value);b&&d.push(b.value)}),d}function j(a){for(var b=0;b<a.length;b++)if(!c.isChecked(a[b].value))return!1;return!0}function k(){var a=f.$viewValue;a&&(c.count=a.length,c.count===c.options.length?c.allSelected=!0:c.allSelected=!1)}function l(a){return function(){if(!c.open)return void(c.open=!0);var b=c.filteredOptions;if(""===s)return s=b[0],void n();var d=b.indexOf(s);s=d+a>b.length-1?b[0]:d+a<0?b[b.length-1]:b[d+a],n()}}function m(a){"select-all"===a.target.id?c.toggleSelectAll(a):c.open&&""!==s?""!==s&&c.setSelectedItem(s,a):c.open=!0}function n(){if(""!==s)for(var a=d.find("li"),b=0;b<a.length;b++)if(a[b].id===s.value)return void a[b].focus()}function o(a,b){return-1!==r(a,b)}function p(a,b){var c=r(a,b);return-1!==c?a[c]:null}function q(a,b){var c=r(a,b);return-1!==c&&a.splice(c,1),a}function r(a,c){for(var d=0;d<a.length;d++)if(b.isDefined(a[d].value)){if(b.equals(a[d].value,c))return d}else if(b.equals(a[d],c))return d;return-1}var s="";c.open=!1,c.allSelected=!1,c.limitNo=8,c.limit=c.limitNo,c.showAll=!1,c.$watchCollection(function(){return f.$viewValue},function(){g(),k(),f.$commitViewValue()});var t=c.$watch("preselected",function(a){a&&a.length>0&&(t(),f.$setViewValue(a),f.$setPristine())},!0);f.$isEmpty=function(){return!f.$modelValue||0===f.$modelValue.length},c.toggleDropdown=function(){c.open=!c.open},c.toggleSelectAll=function(a){a.stopPropagation(),c.isDisabled||(c.filteredOptions.length!==c.options.length?j(c.filteredOptions)?v():u():c.allSelected?v():u())};var u=function(){if(!c.isDisabled)if(c.filteredOptions.length===c.options.length)c.saveValueOnly?f.$setViewValue(i(c.options)):f.$setViewValue(b.copy(c.options));else{for(var a=f.$viewValue||[],d=0;d<c.filteredOptions.length;d++)o(a,c.filteredOptions[d].value)||(a=c.saveValueOnly?a.concat(b.copy(c.filteredOptions[d].value)):a.concat(b.copy(c.filteredOptions[d])));f.$setViewValue(a)}},v=function(){if(!c.isDisabled)if(c.filteredOptions.length===c.options.length)f.$setViewValue([]);else{for(var a=f.$viewValue||[],b=0;b<c.filteredOptions.length;b++)o(a,c.filteredOptions[b].value)&&(a=q(a,c.filteredOptions[b].value));f.$setViewValue(a)}};c.setSelectedItem=function(a,b){if(b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation(),c.isDisabled)return!1;var d=a.value,e=f.$viewValue||[];return c.saveValueOnly?p(e,d)?f.$setViewValue(q(e,d)):f.$setViewValue(e.concat(d)):o(e,d)?f.$setViewValue(q(e,d)):f.$setViewValue(e.concat(a)),f.$setDirty(),s=a,n(),!1},c.$on("schemaFormValidate",function(){f.$commitViewValue(),f.$validate()}),c.isChecked=function(a){return f.$viewValue&&o(f.$viewValue,a)},c.keyBoardPointer=function(a){return s.value===a},c.toggleShowAll=function(){c.showAll=!c.showAll,c.showAll?c.limit=c.options.length:c.limit=c.limitNo};var w={32:{name:"space",preventDefault:!0},13:{name:"enter",preventDefault:!0},38:{name:"arrowUp",preventDefault:!0},40:{name:"arrowDown",preventDefault:!0},27:{name:"escape",preventDefault:!1}},x={enter:function(a){m(a)},space:function(a){m(a)},arrowUp:l(-1),arrowDown:l(1),escape:function(){c.open=!1,c.clearCurrentSelected()}};d.on("keydown",function(a){if(!e.disabled){var b=w[a.keyCode];b&&(b.preventDefault&&a.preventDefault(),x[b.name](a),c.$digest())}}),d.on("click",function(a){a.stopPropagation()}),document.addEventListener("click",function(){c.onBlur(),c.$digest()}),c.onBlur=function(){c.open=!1,c.clearCurrentSelected(),f.$validate()},c.onMenuMouseDown=function(a){return a.preventDefault(),a.stopPropagation(),!1},c.highlightMatching=function(b,c){return c?a.trustAsHtml(b.replace(new RegExp(c,"gi"),'<span class="highlightedText">$&</span>')):a.trustAsHtml(b)},c.clearCurrentSelected=function(){s=""}},templateUrl:"scripts/common/views/directives/multiselect-dropdown.tpl.html"}}),b.module("TT-UI.Common.Directives.NavMenu",["TT-UI.Common.States","TT-UI.Common.Translate"]).directive("navMenu",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{state:"@"},controller:["$scope","$state","$stateParams",function(a,b,c){a.links=[],a.asideLinks=[],a.params=c,a.goTo=function(a){b.go(a.name,c,{reload:!0,notify:!a.locale})};for(var d,e=b.$current,f=!1;e.parent;)if(e=e.parent,e.name===a.state){f=!0;break}f||(d=function(b){return b.name===a.state&&(e=b,f=!0),!f&&b.children&&b.children.length?f=b.children.some(d):f})(e),f&&(a.links.length=0,a.asideLinks.length=0,e.children&&e.children.forEach(function(b){b.label&&(b.aside?a.asideLinks.push(b):a.links.push(b))})),a.isStateActive=function(a){return b.$current.includes[a.name]}}],template:'<nav class="main-menu"><ul><li ng-repeat="state in links" ng-class="{selected: isStateActive(state), home: state.name === \'home\'}"><a href="#{{state.url.format(params)}}" ng-click="goTo(state); $event.preventDefault()" ng-bind="state.label"></a></li></ul><div class="right"><a ng-repeat="state in asideLinks" href="#{{state.url.format(params)}}" ng-click="goTo(state); $event.preventDefault()" class="{{state.className}}" title="{{state.label | translate}}" data-action="{{state.data.action}}" data-role="{{state.data.role}}"></a></div></nav>'}}),b.module("TT-UI.Common.Directives.Pagination",["ui.router","TT-UI.Common.Translate"]).filter("range",function(){return function(a,b,c){for(c||(c=b,b=1),b=parseInt(b,10),c=parseInt(c,10),b;b<=c;b++)a.push(b);return a}}).constant("PAGINATION",{STATE_PARAM:"page"}).directive("pagination",function(){return{restrict:"E",replace:!0,transclude:!1,scope:{pages:"=",page:"="},controller:["$scope","$state","$stateParams","PAGINATION",function(a,c,d,e){a.showPrev=function(){return a.page>1},a.showNext=function(){return a.page<a.pages},a.hasPages=function(){return a.pages&&a.pages>1},a.isCurrent=function(b){return b===a.page},a.goToPrevPage=function(){a.changePage(a.getPrevPage())},a.goToFirstPage=function(){a.changePage(a.getFirstPage())},a.goToNextPage=function(){a.changePage(a.getNextPage())},a.goToLastPage=function(){a.changePage(a.getLastPage())},a.getFirstPage=function(){return 1},a.getNextPage=function(){var b=a.page+1;return b>a.getLastPage()&&(b=a.getLastPage()),b},a.getPrevPage=function(){var b=a.page-1;return b<1&&(b=1),b},a.getLastPage=function(){return a.pages},a.changePage=function(f){if(f!==a.page){f<1?f=1:f>a.pages&&(f=a.pages);var g={};g[e.STATE_PARAM]=f,g=b.extend({},d,g),c.go(c.current,g)}}}],template:'<section class="pager-container"><ul class="inline-pager" ng-show="hasPages()" data-role="pagination"><li class="pager-prev" ng-click="goToFirstPage()" ng-class="{enabled: showPrev(), disabled: !showPrev()}" data-role="first-page" data-page="{{getFirstPage()}}" title="{{\'First page\' | translate}}">&lt;&lt;</li><li class="pager-prev" ng-click="goToPrevPage()"  ng-class="{enabled: showPrev(), disabled: !showPrev()}" data-role="prev-page"  data-page="{{getPrevPage()}}"  translate="&amp;lt; Prev">&lt; Prev</li><li ng-repeat="page in [] | range:pages" ng-click="changePage(page)" ng-class="{enabled: !isCurrent(page), current: isCurrent(page)}" data-role="page" data-page="{{page}}" ng-bind="page"></li><li class="pager-next" ng-click="goToNextPage()" ng-class="{enabled: showNext(), disabled: !showNext()}" data-role="next-page" data-page="{{getNextPage()}}" translate="Next &amp;gt;">Next &gt;</li><li class="pager-next" ng-click="goToLastPage()" ng-class="{enabled: showNext(), disabled: !showNext()}" data-role="last-page" data-page="{{getLastPage()}}" title="{{\'Last page\' | translate}}">&gt;&gt;</li></ul></section>'}}),b.module("TT-UI.Common.Directives.PostMessage",[]).constant("POST_MESSAGE",{SEND_EVENT:"$sendMessage",GREETINGS_INTERVAL:100,MSG_HANDSHAKE:"handshake",MSG_WELCOME:"welcome",MSG_GREETINGS:"greetings"}).directive("postMessage",["$window","$interval","POST_MESSAGE",function(a,c,d){var e,f,g={queue:[],run:function(){}};return{restrict:"A",controller:function(){e=c(function(){f(null,d.MSG_HANDSHAKE,"welcome")},d.GREETINGS_INTERVAL),e.catch(function(){g.run=f,g.queue.forEach(function(a){g.run({},a.type,a.data)})})},compile:function(){return g.queue.length=0,g.run=function(a,b,c){g.queue.push({type:b,data:c})},function(h,i){var j,k=h.$root;j=k.$on(d.SEND_EVENT,g.run),h.$on("$destroy",j),h.frameWin=i.get(0).contentWindow,b.element(a).bind("message",function(a){a.originalEvent&&(a=a.originalEvent);var b=a.data||{};b.type&&b.type===d.MSG_HANDSHAKE&&b.data===d.MSG_GREETINGS&&c.cancel(e)}),f=function(a,b,c){if(h.frameWin){var d={status:200,type:b,data:c};h.frameWin.postMessage(d,"*")}}}}}}]),b.module("TT-UI.Common.Directives.ProgressBar",[]).directive("progressBar",function(){return{restrict:"E",replace:!0,scope:{value:"@"},link:function(a,b){a.$watch("value",function(a){b.children().css("width",a+"%")})},template:'<div class="progress-bar"><span class="value" data-value="{{value}}"></span></div>'}}),b.module("TT-UI.Common.Directives.RouteLabel",["ui.router"]).directive("routeLabel",function(a){return{restrict:"A",transclude:!0,controller:["$scope","$state",function(a,b){a.currentState={label:""},a.currentStateRefreshToggle=!1;var c=a.$on("$stateChangeSuccess",function(){for(var c,d=b.$current;d;){if(d.label&&d.url&&!d.isStep){c=d;break}d=d.parent}a.currentState=c,a.currentStateRefreshToggle=!a.currentStateRefreshToggle});a.$on("$destroy",c)}],link:function(b,c){b.$watch(function(a){return a.currentState&&a.currentState.label?a.currentStateRefreshToggle:null},function(){c.text(a(b.currentState.label))})}}});var D=b.module("TT-UI.Common.Directives.RtlHref",["TT-UI.Common.Services.Rtl"]);r.$inject=["$rootScope","rtlService"],D.directive("rtlHref",r),b.module("TT-UI.Common.Directives.Select",[]).directive("selectUi",function(){return{restrict:"C",link:function(a,b){b.wrap('<div class="styled-select" />');var c=b.parent();b.hasClass("length-small")&&c.addClass("length-small"),b.hasClass("length-medium")&&c.addClass("length-medium")}}});var D=b.module("TT-UI.Common.Directives.SimpleTimeline",[]);D.filter("timelineRangeFilter",function(){return function(a,b){if(!b.showDateFilter)return b.filteredEventsLength=a.length,a;for(var d=[],e=new Date(b.startTime),f=new Date(b.endTime),g=a.length-1;g>=0;g--){var h=new Date(a[g].time);a[g].time===c?d.push(a[g]):h>=e&&h<=f&&d.push(a[g])}return b.filteredEventsLength=d.length,d}}),D.filter("timelineContentFilter",function(a){return function(b,c){if(!c.filter)return c.filteredEventsLength=b.length,b;var d=a("filter")(b,{type:c.filter.type,status:c.filter.status});return c.filteredEventsLength=d.length,d}}),D.filter("timelineOrderByFilter",function(a){return function(b){return a("orderBy")(b,"time",!0)}}),s.$inject=["$filter","$parse"],D.directive("simpleTimeline",s),b.module("TT-UI.Common.Directives.Sortable",["ui.router","TT-UI.Common.Directives.Pagination"]).constant("SORTABLE",{CLASS_ASC:"asc",CLASS_DESC:"desc",ORDER_ASC:"asc",ORDER_DESC:"desc",STATE_PARAM_SORT:"sort",STATE_PARAM_ORDER:"order",EVENT_CHANGE:"$sortable.change"}).directive("sortable",["$stateParams","$state","PAGINATION","SORTABLE",function(a,c,d,e){return{restrict:"C",link:function(f,g,h){var i,j=f.$root,k=a[e.STATE_PARAM_SORT]||null,l=a[e.STATE_PARAM_ORDER]||null,m=null;if(k===h.sort){switch(l){case e.ORDER_ASC:m=e.CLASS_ASC;break;case e.CLASS_DESC:m=e.CLASS_DESC}m&&g.addClass(m)}i=j.$on(e.EVENT_CHANGE,function(a,b){b!==h.sort&&g.removeClass(e.CLASS_ASC).removeClass(e.CLASS_DESC)}),f.$on("$destroy",i),g.bind("click",function(f){f.preventDefault();var i,k={};g.hasClass(e.CLASS_ASC)?(i=e.ORDER_DESC,g.addClass(e.CLASS_DESC).removeClass(e.CLASS_ASC)):(i=e.ORDER_ASC,g.addClass(e.CLASS_ASC).removeClass(e.CLASS_DESC)),j.$emit(e.EVENT_CHANGE,h.sort),k[d.STATE_PARAM]=1,k[e.STATE_PARAM_SORT]=h.sort,k[e.STATE_PARAM_ORDER]=i,k=b.extend({},a,k),c.go(c.current,k)})}}}]),b.module("TT-UI.Common.Directives.SpinnerInside",["ui.router"]).constant("SPINNER_INSIDE_EVENTS",{SHOW:"TT-UI.Common.Directives.SpinnerInside.Show",HIDE:"TT-UI.Common.Directives.SpinnerInside.Hide"}).constant("SPINNER_INSIDE_CONFIG",{DEFAULT_MESSAGE:"Please wait"}).directive("spinnerInside",["$rootScope","SPINNER_INSIDE_EVENTS","SPINNER_INSIDE_CONFIG",function(a,c,d){return{restrict:"A",template:function(a){a.append('<div class="spinner-overlay spinner-inside hidden"><div class="content"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span><span>{{ message }}</span></div></div>'),a.addClass("spinner-container")},link:{post:function(e,f){var g=[],h=f.children("div").eq(-1),i=b.element(h);e.message=d.DEFAULT_MESSAGE,g.push(a.$on(c.SHOW,function(a,b){e.message=b&&b.message?b.message:d.DEFAULT_MESSAGE,i.removeClass("hidden")})),g.push(a.$on(c.HIDE,function(){i.addClass("hidden")})),e.$on("$destroy",function(){g.forEach(function(a){a()})})}}}}]),b.module("TT-UI.Common.Directives.Spinner",["ui.router"]).constant("SPINNER_EVENTS",{SHOW:"TT-UI.Common.Directives.Spinner.Show",HIDE:"TT-UI.Common.Directives.Spinner.Hide"}).constant("SPINNER_CONFIG",{DEFAULT_MESSAGE:"Please wait"}).directive("spinnerOverlay",["$rootScope","SPINNER_EVENTS","SPINNER_CONFIG",function(a,b,c){return{restrict:"E",template:'<div ng-show="spinnerOverlayVisible" class="spinner-overlay"><div class="content"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span><span>{{ message }}</span></div></div>',link:function(d){var e=[];d.spinnerOverlayVisible=!1,d.message=c.DEFAULT_MESSAGE,e.push(a.$on(b.SHOW,function(a,b){d.message=b&&b.message?b.message:c.DEFAULT_MESSAGE,d.spinnerOverlayVisible=!0})),e.push(a.$on(b.HIDE,function(){d.spinnerOverlayVisible=!1})),d.$on("$destroy",function(){e.forEach(function(a){a()})})}}}]),b.module("TT-UI.Common.Directives.Tabs",["ui.router","TT-UI.Common.Translate"]).directive("tabset",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{viewName:"@"},controller:["$scope","$state","$timeout",function(a,b,c){a.templateUrl="",a.tabs=[];var d=a.tabs,e=b.$current,f=b.$current.name,g=b.$current.parent.name,h=!0,i=this;e.modal&&(f=g,g=e.parent.parent.name),this.selectTab=function(a,c){d.forEach(function(a){a.selected=!1}),f=a.state,a.selected=!0,i.setTabTemplate(a.templateUrl),c||b.go(f)},this.setTabTemplate=function(b){a.templateUrl=b},this.addTab=function(a){f===a.state&&(i.selectTab(a,!0),h=!1),d.push(a)},c(function(){h&&d.length&&i.selectTab(d[0])},0);var j=a.$on("$stateChangeSuccess",function(a,b,c,e){if(b.name!==e.name&&b.name!==f&&!b.modal){var g;d.some(function(a){if(a.state===b.name)return g=a,!0}),i.selectTab(g||d[0],!!g)}});a.$on("$destroy",j)}],template:'<div class="tabs ui-tabs ui-widget ui-widget-content ui-corner-all"><ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all" ng-transclude></ul><ui-view></ui-view></div>'}}).directive("tab",function(){return{restrict:"E",replace:!0,require:"^tabset",scope:{title:"@",state:"@",templateUrl:"@"},link:function(a,b,c,d){d.addTab(a),a.select=function(){d.selectTab(a)}},template:'<li class="ui-state-default" ng-class="{\'ui-state-active\': selected}"><a href="" ng-click="select()" ng-bind="title | translate"></a></li>'}}),b.module("TT-UI.Common.Directives.Toggle",[]).directive("toggle",function(){return{restrict:"E",replace:!0,transclude:!0,require:"^ngModel",scope:{ngModel:"=",on:"=?"},link:function(a,c){a.on=!!b.isDefined(a.on)&&a.on,c.find('input[type="checkbox"]').prop("checked",a.on),a.ngModel=a.on},template:function(){var a=function(){return Date.now().toString(32)+Math.random().toString(32)},b="toggle-"+a();return'<div class="toggle-on-off"><input type="checkbox" id="'+b+'" ng-model="ngModel" /><label for="'+b+'"></label></div>'}}}),b.module("TT-UI.Common.Errors",["ui.router","TT-UI.Common.Routes","TT-UI.Common.Services.FlashMessage","TT-UI.Common.Services.ErrorsInterceptor","TT-UI.Common.ErrorMessageString"]).run(["$rootScope","$log","ERRORS_HANDLING","FlashMessage","createErrorMessageString",function(a,c,d,e,f){function g(a){b.forEach(a,function(a){c.error(a),e.show("Error",a.description,"danger")})}function h(a){return b.isArray(a)}var i=!1;a.$on("$stateChangeStart",function(){i=!0}),a.$on("$stateChangeSuccess",function(){i=!1}),a.$on("$stateChangeError",function(a,b,d,j,k,l){if(i=!1,h(l))return g(l);var m=f(l);c.error(m),e.show("Error",m,"danger")}),a.$on(d.RESOURCE_FETCH_ERROR_EVENT,function(a,b){i||g(b)})}]),b.module("TT-UI.Common.Filters",["TT-UI.Common.Filters.DateFilter","TT-UI.Common.Filters.ObjectFieldFilter","TT-UI.Common.Filters.RegExpFilter"]),b.module("TT-UI.Common.Filters.DateFilter",["TT-UI.Config","TT-UI.Common.MomentProvider"]).constant("timezoneISO8601","tz").config(["$provide","timezoneISO8601","momentProvider",function(a,c,d){function e(a){var b="";return a<0&&(b="-",a=-a),a<10&&(a="0"+a),b+a}function f(a){var b=-1*a.getTimezoneOffset(),c=b>=0?"+":"";return c+=e(Math[b>0?"floor":"ceil"](b/60)),c+=":",c+=e(Math.abs(b%60))}a.decorator("dateFilter",["$delegate","CONFIG",function(a,e){var g=a,h=d.getMoment();return function(a,d,i){d=d||e.DATE_FORMAT;var j;return j=/^j+/.test(d)&&a&&h(a).isValid()?h(a).format(d):g.call(g,a,d,i),!b.isString(j)||b.isString(a)?j:j.replace(c,f(a))}}])}]),b.module("TT-UI.Common.Filters.IsArrayFilter",[]).filter("isArray",[function(){return function(a,c){var d=b.isArray(a);return b.isUndefined(c)?d:!d}}]);var D=b.module("TT-UI.Common.Filters.ObjectFieldFilter",[]);D.filter(t.name,t);var D=b.module("TT-UI.Common.Filters.RegExpFilter",[]);D.filter(u.name,u),b.module("TT-UI.Common.Helpers.Form",["schemaForm","TT-UI.Common.Helpers.XhrHelper","TT-UI.Common.Services.FieldMapping"]).constant("FORM_HELPER",{DEFAULT_VALUE:"Y"}).service("FormHelper",["$log","$q","$parse","sfPath","XhrHelper","FieldMapping","FORM_HELPER",function(a,c,d,e,f,g,h){function i(a,b){var c;return a.some(function(a){return a.default===b&&(c=a.code),c}),c}function j(a,c){var d,e=a.enum;b.isArray(a.enum)?(e.length=0,e.push.apply(e,c),d=i(c,h.DEFAULT_VALUE)):b.isDefined(c.code)&&(d=c.code),b.isDefined(d)&&(a.default=d)}function k(a,c,d){var e=a[c];if(b.isUndefined(e))throw new Error('Can not get property by key "'+c+'" for schema JSON path "'+d+'"');return"array"===e.type&&e.items&&b.isObject(e.items)&&(e=e.items),"object"===e.type&&e.properties&&b.isObject(e.properties)&&(e=e.properties),e}this.putJsonDeferred=f.putJsonDeferred,this.loadJsonDeferred=f.loadJsonDeferred,this.postJsonDeferred=f.postJsonDeferred,this.loadMetaInformationDeffered=function(a,b){return this.loadJsonDeferred(b).then(function(b){return{path:a,json:b}})},this.loadAllMetaInformation=function(a){return c.all(a).then(function(a){var b={};return a.forEach(function(a){b[a.path]=a.json}),b})},this.mergeExtractedMasterData=function(a){return c.all(a).then(function(a){var b={};return a.forEach(function(a){b[a.schema]=a.data}),b})},this.populateSchemaWithMasterData=function(a,b,c){var d=this.extractValuesFromMasterData(b,c);this.applyValuesToSchema(a,d)},this.extractValuesFromMasterData=function(a,c){var e={};return b.forEach(c,function(b,c){e[c]=d(b)(a)}),e},this.applyValuesToSchema=function(a,c){b.isObject(c)&&b.isObject(a.properties)&&b.forEach(c,function(b,c){this.iterateMasterInformation(a,c,b)},this)},this.getDefaultValueFromMasterData=i,this.iterateMasterInformation=function(a,c,d){if(b.isUndefined(d))throw new Error('Values object for schema "'+c+'" is not defined');for(var f,g=e.parse(c).filter(function(a){return a}),h=a.properties;f=g.shift();)h=k(h,f,c);j(h,d)},this.copyValues=function(a,c){a.forEach(function(a){this.fixArrayParse(a.dest,c);var e=d(a.source)(c),f=d(a.dest)(c);b.isUndefined(e)||f||d(a.dest).assign(c,b.copy(e))},this)},this.copyValuesFrom=function(a,c,e){return a.forEach(function(a){this.fixArrayParse(a.dest,e);var f=d(a.source)(c),g=d(a.dest)(e),h=a.destinationCondition&&!d(a.destinationCondition)(e),i=a.sourceCondition&&!d(a.sourceCondition)(c),j=h||i,k=!g;b.isDefined(f)&&k&&!j&&d(a.dest).assign(e,b.copy(f))},this),e},this.convertValues=function(a,c){function e(a){return!a.hasOwnProperty("setBooleanIfExists")}function f(a){return"boolean"===a.modelType}function h(a){switch(a.toLowerCase()){case"y":return!0;case"n":return!1;default:return a}}var i={};return a.filter(e).forEach(function(a){var e=g.extractFields(c,a.serverPath,a.modelPath);b.isArray(e)&&e.length&&e.forEach(function(b){var e=d(b.sourcePath)(c);f(a)&&(e=h(e)),null===e&&(e=""),this.fixArrayParse(b.targetPath,i),d(b.targetPath).assign(i,e)},this)},this),i},this.fixArrayParse=function(a,b){a.match(/\[[0-9]+\]/)&&this.assignArray(a,b)},this.assignArray=function(a,c){var e=a.split(/\[([0-9]+)\]/),f=e.length;if(1!==f){""===e[f-1]&&e.pop();var g=function(a){return parseInt(a,10).toString()===a},h="";e.forEach(function(a){if(!g(a))return void(h+=a);var e=d(h);b.isArray(e(c))||e.assign(c,[]),h+="["+a+"]"})}},this.enumToTitleMapFromMasterData=function(c,d){var e=c.schema.enum;if(e.length=0,c.titleMap.length=0,!c.schema.hasOwnProperty("masterData"))return void a.error("Field schema masterData are missing",c.schema,d);c.schema.masterData.forEach(function(a){var f=this.findObjectByCode(d,a.code);b.isDefined(f)&&(c.titleMap.push({name:a.name,value:a.code}),e.push(a.code))},this),c.required||e.push(null)},this.enumToTitleMapFromObject=function(a,b){var c=a.schema.enum;c.length=0,a.titleMap.length=0,b.forEach(function(b){a.titleMap.push({name:b.name,value:b.code}),c.push(b.code)}),a.required||c.push(null)},this.findObjectByCode=function(a,b){return a.filter(function(a){return a.masterCode===b})[0]},this.triggerFormValidation=function(a){var b=function(a){return"$"!==a[0]},c=function(b){return a[b].$name===b},d=function(b){var c=a[b];c.$validate(),c.$invalid&&c.$setDirty()};Object.keys(a).filter(b).filter(c).forEach(d)}}]);var D=b.module("TT-UI.Common.Helpers.XhrHelper",[]);v.$inject=["$http","$q"],D.service(v.name,v),b.module("TT-UI.Common",["ng","ui.router","angular-storage","TT-UI.Form","TT-UI.Common.Config","TT-UI.Common.States","TT-UI.Common.Errors","TT-UI.Common.Routes","TT-UI.Common.Directives","TT-UI.Common.Filters","TT-UI.Common.Services","TT-UI.Common.Helpers.XhrHelper","TT-UI.Common.Helpers.Form","TT-UI.Common.Translate","TT-UI.Common.AngularStrap","TT-UI.Common.Spread","TT-UI.Common.Tv4"]),b.module("TT-UI.Common.MomentProvider",[]).provider("moment",function(){this.getMoment=function(){return a.moment},this.$get=function(){return this}}),b.module("TT-UI.Common.Routes",["TT-UI.Config","TT-UI.Common.States"]).config(["$stateProvider","$urlRouterProvider","CONFIG",function(a,b){var c=function(a,b,c){b(function(){a.go(c.HOME_STATE)})};c.$inject=["$state","$timeout","CONFIG"],b.when("",c),b.when("/",c),a.state("index",{abstract:!0,url:"/",label:""})}]),b.module("TT-UI.Common.Services",["TT-UI.Common.Services.Api","TT-UI.Common.Services.ModalDialog","TT-UI.Common.Services.ConfirmationDialog","TT-UI.Common.Services.DataObject","TT-UI.Common.Services.FieldMapping","TT-UI.Common.Services.FlashMessage","TT-UI.Common.Services.FormValidator","TT-UI.Common.Services.FormFactory","TT-UI.Common.Services.NotJsonParser","TT-UI.Common.Services.Resource","TT-UI.Common.Services.ErrorsInterceptor","TT-UI.Common.Services.ResourceResponseParser","TT-UI.Common.Services.Rtl"]),b.module("TT-UI.Common.Services.Api",["TT-UI.Config"]).factory("Api",["CONFIG",function(a){var b=/[\/]?$/,c=a.API_URL.replace(b,"")+"/",d=a.MOCK_API_URL.replace(b,"")+"/",e=a.UPC_API_URL.replace(b,"")+"/",f=a.CLM_360_URL.replace(b,"")+"/",g=a.CLM_360_API_URL.replace(b,"")+"/";return{getUrl:function(){return c},getMockUrl:function(){return d},getUpcUrl:function(){return e},getClm360Url:function(){return f},getClm360ApiUrl:function(){return g}}}])
;var D=b.module("TT-UI.Common.Services.ConfirmationDialog",["ui.router","TT-UI.Common.Services.ModalDialog"]);w.$inject=["$rootScope","$q","ModalDialog","translateFilter"],D.service("ConfirmationDialog",w),b.module("TT-UI.Common.Services.DataObject",[]).factory("DataObject",[function(){function a(){}return a.prototype={setData:function(a){a&&(b.extend(this,a),this.initDataObject())},initDataObject:function(){},getName:function(){return this.name},getCode:function(){return this.code},getDescription:function(){return this.description}},a}]).factory("DataObjectCollection",function(){function a(){}return a.prototype={setData:function(a){a&&b.extend(this,a),this.dataObjects=this.initDataObjects()},initDataObjects:function(){return[]},getDataObjectByName:function(a){return this.getDataObjectBy("name",a)},getDataObjectByCode:function(a){return this.getDataObjectBy("code",a)},getDataObjectBy:function(a,b){for(var c=0;c<this.dataObjects.length;c++)if(this.dataObjects[c][a]===b)return this.dataObjects[c];return null},getAllDataObjects:function(){return this.dataObjects}},a}),b.module("TT-UI.Common.ErrorMessageString",[]).factory("createErrorMessageString",["ErrorsDictionary","$parse",function(a,c){return function(d){if(b.isArray(c("data[0].response.errors.error")(d))){var e=c("data[0].response.errors.error")(d),f=e[e.length-1];return a.getError(f.desc)||f.desc}return"object"==typeof d?a.getError(d.statusText)||a.getError(d.status)||d.statusText||d.status||"Unknown error":a.getError(d)||d||"Unknown error"}}]),b.module("TT-UI.Common.Services.ErrorsInterceptor",[]).config(["$httpProvider",function(a){a.interceptors.push("ErrorsInterceptor")}]).constant("ERRORS_HANDLING",{ERRORS_PATH:"response.errors.error",DEFAULT_ERROR_DESCRIPTION:"Unknown Error",RESOURCE_FETCH_ERROR_EVENT:"resourceFetchError"}).factory("emitErrorPopupFn",["$rootScope","ERRORS_HANDLING",function(a,b){return function(c){a.$emit(b.RESOURCE_FETCH_ERROR_EVENT,c)}}]).provider("ErrorsDictionary",function(){var a={};this.setDictionary=function(b){a=b.errors||{}},this.$get=function(){function b(b){return a[b.code]||a[b]||b.desc}return{getError:b,errorsDictionary:a}}}).factory("parseErrorsFn",["$parse","$log","ErrorsDictionary","ERRORS_HANDLING",function(a,c,d,e){function f(a){var f=d.getError(a);return(b.isUndefined(a.code)||b.isUndefined(f))&&(c.error("Backend Error Interceptor: Error Code or Error Description is undefined. code: "+a.code+", description: "+f),f=e.DEFAULT_ERROR_DESCRIPTION),f}return function(c){var d=a(e.ERRORS_PATH)(c);return!b.isUndefined(d)&&(b.isArray(d)?d.map(function(a){return{code:a.code,description:f(a)}}):d)}}]).factory("ErrorsInterceptor",["$q","parseErrorsFn","emitErrorPopupFn",function(a,b,c){return{responseError:function(d){var e=b(d&&d.data);return e?(c(e),a.reject(e)):a.reject(d)}}}]);var D=b.module("TT-UI.Common.Services.FieldMapping",[]);x.$inject=["$log","$parse"],D.factory(x.name,x),b.module("TT-UI.Common.Services.FlashMessage",["ngSanitize","ui.router","TT-UI.Common.AngularStrap","TT-UI.Common.Translate"]).service("FlashMessage",["$rootScope","$alert","$document","translateFilter",function(a,c,d,e){function f(a,d,e){var f=c(h);return b.extend(f.$options,{title:g(a),content:g(d),type:e}),b.extend(f.$scope,f.$options),j.push(f),f}var g=e,h={title:"",content:"",type:"info",placement:"top",container:d[0].querySelector("alerts-container")?"alerts-container":"body",show:!1},i=!1,j=[];a.$on("$stateChangeStart",function(){if(i)return void(i=!1);this.hide()}.bind(this)),this.show=function(a,b,c,d){var e=f(a,b,c);i=!!d,e.$promise.then(e.show)},this.hide=function(){b.forEach(j,function(a){a.hide()}),j.length=0}}]),b.module("TT-UI.Common.Services.Flow",["TT-UI.Common.Helpers.XhrHelper"]).factory("FlowFactory",["$log","$q","XhrHelper",function(a,c,d){var e=function(a,b,c){this._entryState=a,this._exitState=b,this._states=c};return e.prototype._isStateVisible=function(b){var c=this.getStates();if(!c.hasOwnProperty(b))return a.error("Missing state",b),!1;var d=c[b];return!1!==(null===d||d.visible)},e.prototype._findRelativeNextState=function(a,b){var c,d=Object.keys(this.getStates()),e=b?1:-1,f=function(b,d,f){var g=f[d+e];return a?g===a&&(c=b):c=b,c};return d.filter(this._isStateVisible,this).some(f,this),c},e.prototype.getNextStepState=function(a){return this._findRelativeNextState(a,!1)},e.prototype.getPrevStepState=function(a){return this._findRelativeNextState(a,!0)},e.prototype.getValidators=function(a){var e=this.getStates();if(!e.hasOwnProperty(a))return c.reject("Missing state :"+a);var f=b.isArray(e[a].validators)?e[a].validators:[];return c.all(f.map(d.loadJsonDeferred))},e.prototype.getStates=function(){return this._states},e.prototype.getEntryState=function(){return this._entryState},e.prototype.getExitState=function(){return this._exitState},e.prototype.start=function(){return this.clear(),this.getEntryState()},e.prototype.getSubmitState=function(){a.error("isSubmitStep method must be implemented")},e.prototype.clear=function(){a.error("clear method must be implemented")},e.prototype.resume=function(){throw new Error("resume method must be implemented")},e.prototype.persist=function(){throw new Error("persist method must be implemented")},e.prototype.store=function(){throw new Error("store method must be implemented")},e.prototype.submit=function(){throw new Error("submit method must be implemented")},e.prototype.cancel=function(){throw new Error("cancel method must be implemented")},e.prototype.finish=function(){throw new Error("finish method must be implemented")},e.prototype.isValid=function(){throw new Error("isValid method must be implemented")},e}]);var D=b.module("TT-UI.Common.Services.FormFactory",["schemaForm","TT-UI.Common.Helpers.XhrHelper","TT-UI.Common.Helpers.Form","TT-UI.Common.Spread"]);y.$inject=["$q","XhrHelper","FormHelper"],D.factory("FormFactory",y),b.module("TT-UI.Common.Services.FormValidator",["schemaForm","TT-UI.Config","TT-UI.Common.Services.Validator"]).constant("VALIDATION_EVENTS",{VALIDATE:"schemaFormValidate",STATUS:"$validation",IN_PROGRESS:"$validation.inProgress",VALID:"$validation.valid",INVALID:"$validation.invalid"}).factory("PathName",function(){return{get:function(a){return a.join(".").replace(/\.([0-9]+)/,"[$1]")}}}).directive("sfValidate",["$timeout","VALIDATION_EVENTS",function(a,b){return{resrict:"A",require:["^form","^sfSchema"],priority:100,controller:function(c){function d(){c.$broadcast(b.VALIDATE)}var e;this.fieldNotify=function(){a.cancel(e),e=a(d,250)}}}}]).directive("schemaName",["PathName",function(a){return{restrict:"A",replace:!1,scope:!1,priority:100,require:["ngModel","^sfValidate"],link:function(b,c,d,e){var f=a.get(b.form.key),g=e[0];c.attr("name",f),b.formCtrl.$$renameControl(g,f)}}}]).provider("FormValidator",[function(){var a={},c={};this.$get=["$injector","$rootScope","$q","Validator","VALIDATION_EVENTS","CONFIG",function(d,e,f,g,h,i){var j=function(b,c){var d;c.validators.forEach(function(b){d=a[b],this._runValidation(d,c)},this)},k=function(c,d){var e=c.$watch(d,function(c){d&&(e(),b.forEach(a,function(a){a.setForm(c)}))})},l=function(a,c){var d=a.getForm();b.isDefined(d)&&e.$emit(h.IN_PROGRESS,d.$name,a,c)},m=function(a,c,d,f){var g=a.getForm();if(b.isDefined(g)&&(e.$emit(h.STATUS,g.$name,a,c,d,f),"boolean"==typeof c)){var i=c?h.VALID:h.INVALID;e.$emit(i+"."+a.getRuleName(),g.$name,a,c,d,f)}};return{registerValidators:function(a,b,c,d){d.forEach(function(a){-1===(i.DISABLED_VALIDATORS||[]).indexOf(a.validator)&&this.registerValidator(a.validator,a,c)},this),k(a,b)},unregisterAllValidators:function(){Object.keys(a).forEach(function(a){this.unregisterValidator(a)},this)},unregisterValidators:function(a){a.forEach(function(a){this.unregisterValidator(a.validator)},this)},registerValidator:function(e,f,h){var i=d.get(e);if(!(i.prototype instanceof g))throw new Error('Given service name "'+e+'" is not a Validator instance');var j=new i(e,f.name,f.inline).setModel(h).setSchema(f.schema).setFormNotification(f.formNotification).setReportConfig(f.report);return b.forEach(j.getSchema(),function(a){if(b.isArray(c[a])){if(-1!==c[a].indexOf(e))return}else c[a]=[];c[a].push(e)}),a[e]=j,j},unregisterValidator:function(d){if(!a.hasOwnProperty(d))throw new Error('Given validator name "'+d+'" is not registered');var e=a[d];delete a[d],b.forEach(e.getSchema(),function(a){if(c.hasOwnProperty(a)){var b=c[a],e=b.indexOf(d);b.splice(e,1)}})},registerField:function(a){var d=a.key.reduce(function(a,b,c){return a+(b?c?"."+b:b:"[]")});c.hasOwnProperty(d)&&(a.hasOwnProperty("onChange")||(a.validators=c[d],a.onChange=b.bind(this,j)))},validateForm:function(c,d){if(!this.isFormValid(c)&&d)return f.reject();var e=[];return b.forEach(a,function(a){a.isInline()||e.push(this._runValidation(a))},this),f.all(e).then(function(a){return a.every(function(a){return a.status})})},isFormValid:function(a){return a.$valid},_runValidation:function(a,c){var d;a.notifyForm(!1),c&&c.key.some(function(a){return b.isNumber(a)&&(d=a),d}),l(a,d);var e=function(b){return this._resolveValidation(b,a,d)}.bind(this);return a.validate(d).then(e).catch(e)},_resolveValidation:function(a,b,c){var d=a.status,e=a.message||null;return b.notifyForm(d),b.populateModelWithValidationResult(a,c),m(b,d,e,c),!1===d?f.reject(a):a}}}]}]);var D=b.module("TT-UI.Common.Services.ModalDialog",["ui.router","TT-UI.Common.Config","TT-UI.Common.AngularStrap","TT-UI.Common.Directives"]);D.directive("compileHtml",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compileHtml)},function(d){a(c.append(d).contents())(b)})}}]),D.constant("DIALOG_CONFIG",{EVENT_PREFIX:"modalDialog"}),z.$inject=["$log","$q","$modal","$compile","COMMON_CONFIG","DIALOG_CONFIG"],D.factory("ModalDialog",z),b.module("TT-UI.Common.Services.NotJsonParser",[]).factory("NotJsonParser",function(){var a=/^\[(.*)\]$/m,c=/,\s*/m;return{parse:function(d){if(!d&&!b.isString(d)||!d.match(a))throw new SyntaxError("notJSON Parser: Given data is not a valid notJSON");return d.replace(a,"$1").split(c)}}}),b.module("TT-UI.Common.Services.ResourceResponseParser",[]).constant("RESOURCE_RESPONSE",{BODY_PATH:"response.body"}).factory("resourceResponseParserFn",["$parse","RESOURCE_RESPONSE",function(a,c){var d=function(b){return a(c.BODY_PATH)(b)};return function(a){var c=d(a);return b.isDefined(c)?c:a}}]),b.module("TT-UI.Common.Services.Resource",["ngResource","TT-UI.Config","TT-UI.Common.Services.Api","TT-UI.Common.Services.ResourceResponseParser","TT-UI.Common.Services.ErrorsInterceptor"]).service("ResourceTransform",["$http","$log","resourceResponseParserFn","parseErrorsFn","emitErrorPopupFn",function(a,c,d,e,f){function g(a,d){return b.isArray(a)?(c.error("API response error: Expecting object but instead received array",d,a),a[0]):a}function h(a,d){return b.isArray(a)?a:(c.error("API response error: Expecting array but instead received object",d,a),[a])}this.getTransformations=function(b,c){var e=b?h:g;return a.defaults.transformResponse.concat(d).concat(function(a){return e(a,c)})},this.interceptResponse=function(a){var c,d=a.resource,g=a.data;c=b.isObject(g)&&b.isObject(d)&&g instanceof Blob?g:b.isArray(g)&&b.isArray(d)?d.map(function(a){return a.hasOwnProperty("$promise")?a.toJSON():a}):b.isObject(g)&&b.isObject(d)?d.toJSON():g;var h=e(b.isArray(c)?c[0]:c);return h&&f(h),c}}]).factory("ResourceFactory",["$resource","CONFIG","ResourceTransform",function(a,b,c){return function(d,e,f,g,h){g=!!g;var i=d+e,j={fetch:{method:f,isArray:g,transformResponse:c.getTransformations(g,i),interceptor:{response:c.interceptResponse}}};return h&&(j.fetch.responseType=h),a(i,{tenantId:b.API_TENANT_ID,apiVersion:b.API_VERSION},j)}}]).factory("AlternateApiVersionResourceFactory",["$resource","CONFIG","ResourceTransform",function(a,b,c){return function(d,e,f,g,h){g=!!g;var i=d+e,j={fetch:{method:f,isArray:g,transformResponse:c.getTransformations(g,i),interceptor:{response:c.interceptResponse}}};return h&&(j.fetch.responseType=h),a(i,{tenantId:b.API_TENANT_ID,apiVersion:b.API_VERSION_ALTERNATE},j)}}]);var D=b.module("TT-UI.Common.Services.Rtl",[]);A.$inject=["CONFIG","$translate","$document"],D.service("rtlService",A),D.run(["rtlService",function(a){var b=a.getDirection();a.setDocumentDirection(b)}]);var D=b.module("TT-UI.Common.Services.Validator",["TT-UI.Common.Helpers.Form"]);B.$inject=["$q","$parse","$log","translateFilter","FormHelper"],D.factory("Validator",B),b.module("TT-UI.Common.Spread",[]).config(["$provide",function(a){var c=function(a){return function(b){var c=a.defer();return c.resolve(b),c.promise}};a.decorator("$q",["$delegate",function(a){return b.isUndefined(a.spread)&&(a.spread=function(a,b){return function(c){return a.apply(b,c)}}),b.isUndefined(a.resolve)&&(a.resolve=c(a)),a}])}]),b.module("TT-UI.Common.States",["ui.router"]).config(["$stateProvider","$uiViewScrollProvider",function(a,b){a.decorator("parent",function(a,b){var c=b(a);return c.children||(c.children=[]),c.children.push(a),c}),b.useAnchorScroll()}]),b.module("TT-UI.Common.Translate",["ngCookies","pascalprecht.translate","TT-UI.Config"]).constant("TRANSLATE",{URI_REG_EXP:/(?:\?|\&)locale=([a-z]{2})/i,STATE_NAME_PREFIX:"lang-",LANG_DIR_DEFAULT:"ltr",LANG_DIR_RTL:"rtl"}).factory("$translateTtStorage",["$translateLocalStorage","$window","TRANSLATE",function(a,b,c){var d=b.location;return{get:function(b){var e,f;return d.search&&(f=d.search.match(c.URI_REG_EXP))&&(e=f.pop()),e||a.get(b)},set:a.set,put:a.put}}]).factory("missingTranslationLog",["$log",function(a){return function(b){a.debug('Missing translation: "'+b+'"')}}]).factory("localePartialLoaderErrorHandler",["$q",function(a){return function(){return a.when({})}}]).config(["$translateProvider","$translatePartialLoaderProvider","$windowProvider","CONFIG",function(a,b,c,d){function e(a){var b=a.navigator;return b.hasOwnProperty("languages")?b.languages:b.userLanguage?[b.userLanguage]:[b.language]}a.useStorage("$translateTtStorage"),a.useLoader("$translatePartialLoader",{urlTemplate:d.LOCALE_PATH+"{part}-{lang}"+d.LOCALE_SUFFIX,loadFailureHandler:"localePartialLoaderErrorHandler"}),b.addPart(d.LOCALE_PREFIX),d.LOCALE_OPCO&&b.addPart(d.LOCALE_OPCO),a.determinePreferredLanguage(function(){var a=d.LOCALE_LIST,b=d.LOCALE_DEFAULT;return e(c.$get()).some(function(c){if(c=c.split("-")[0],a.hasOwnProperty(c))return b=c,!0}),b}),a.useMissingTranslationHandler("missingTranslationLog")}]);var D=b.module("TT-UI.Common.Tv4",[]);D.run(C)}(window,window.angular);
//# sourceMappingURL=ttui-common.min.js.map