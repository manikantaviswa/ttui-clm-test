/*! TT-UI Lib 0.6.24.19 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ttui-form"),function(a,b,c){"use strict";function d(){return{BASE_URL:"scripts/form/"}}function e(a,c){function d(c,d){var e=c&&f(c,d);return(b.isUndefined(e)||b.isUndefined(e.$name))&&a.warn('Autopopulate: Missing "'+d+'" ngModel field'),e}function e(a){return!(b.isNumber(a.$modelValue)&&isNaN(a.$modelValue))}function f(a,c){if(a&&b.isUndefined(a[c])&&c.match(/\./)){var d=c.split(".");return f(a[d[0]],d.slice(1).join("."))}return a&&a[c]}function g(a){return s.test(a)}function h(a,b){var d=c(b.replace(s,t)),e=new RegExp("^"+d.replace(t,u)+"$");return function(){return Object.keys(a).filter(i).filter(function(a){return e.test(a)})}}function i(a){return"$"!==a[0]}function j(a,c,e,f){var g=d(a,c);if(g)return k(g,e)&&m(g,b.copy(f)),f}function k(a,c){var d=a.$viewValue;return!a.$touched&&(l(d)||b.equals(d,c.value))}function l(a){return b.isUndefined(a)||null===a}function m(a,b){a.$setViewValue(b),a.$commitViewValue(),a.$render()}function n(a,b,c,d){return h(a,b)().forEach(function(b){j(a,b,c,d)}),d}function o(a,b,c){return g(b)?n.bind(n,a,b,c):j.bind(j,a,b,c)}function p(a){return{value:a.$viewValue}}function q(a,c,d,e){var f=p(c),g=o(a,e,f);return d.$watch(function(){return c.$modelValue},function(a){b.isUndefined(a)||(g(c.$viewValue),f.value=c.$$lastCommittedViewValue)})}function r(a){for(;b.isDefined(a.$$parentForm)&&b.isDefined(a.$$parentForm.$name);)a=a.$$parentForm;return a}var s=/\[\]/,t="%%index%%",u="\\[[0-9]+\\]";return{require:["ngModel","^form"],restrict:"A",priority:500,scope:!1,link:function(a,c,d,f){function g(){m(),l.forEach(function(b){var c=q(i,h,a,b);n.push(c)})}var h=f[0],i=r(f[1]),j="autopopulateTo",k=a.$eval(d[j]),l=k&&k.autopopulateTo;if(b.isArray(l)){var m,n=[];m=a.$watch(function(){return e(h)},g),a.$on("$destroy",function(){n.forEach(function(a){a()})})}}}}function f(a,c,d,e){function f(c,f,h,i){i=i||{},h.forEach(function(e){e.key=g(c,e.key);var h=f[e.key],j=d(e.source)(i,{results:i});if(b.isUndefined(h))return void a.error('Populate directive: Can not find field for path "'+e.key+'"');h.$$autopopulated=!0,h.$setViewValue(j),h.$render()}),f.$commitViewValue(),c.$broadcast(e.VALIDATE)}function g(a,c){var d=a&&a.arrayIndex;return b.isNumber(d)?c.replace(/\[arrayIndex\]/,"["+d+"]"):c}function h(a,b,c,d,e,g){if(g||!b.$$autopopulated){var h=f.bind(f,a,c,e);d(b.$modelValue,a.model).then(h).catch(h)}else b.$$autopopulated=!1}function i(a){return!!c.has(a)&&c.get(a)}function j(a,c){var d=a[c];return!!b.isFunction(d)&&d}return{require:["ngModel","^form"],restrict:"A",scope:!1,link:function(c,d,e,f){var g=f[0],k=f[1],l="populateTo",m=c.$eval(e[l]),n=m&&m.populate;if(!b.isUndefined(n)){var o=b.isUndefined(n.chainingEnabled)||n.chainingEnabled,p=i(n.service),q=j(p,n.action);if(!q)return void a.error('Populate directive: Service "'+n.service+'" or action "'+n.action+'" can not be invoked');g.$viewChangeListeners.push(h.bind(h,c,g,k,q.bind(p),n.populateTo,o))}}}}function g(a,c,d){function e(a){return!(b.isNumber(a.$modelValue)&&isNaN(a.$modelValue))}function f(a,b){return b.replace("[arrayIndex]","["+a+"]")}function g(a,c){var d=a[c];return b.isDefined(d.$modelValue)}function h(a){return!!c.has(a)&&c.get(a)}function i(a,c){var d=a[c];return!!b.isFunction(d)&&d}function j(a,b,c){return c.reduce(function(c,d){var e=f(a,d);return c[d]=b[e],c},{})}function k(a){return Object.keys(a).reduce(function(b,c){var d=a[c];return b[c]=d.$modelValue,b},{})}function l(a,b){a.$setViewValue(b),a.$commitViewValue()}function m(a,c,d,e,f){if(f=f||{},"text"===a.type||"number"===a.type)l(d,e(d,c,f));else{if(e(d,a,f),b.isArray(d.$viewValue)){var g=d.$viewValue.filter(function(c){return b.isArray(a.titleMap)&&a.titleMap.some(function(a){return b.equals(a.value,c)})});g.length!==d.$viewValue.length&&l(d,g)}else{var h=b.isArray(a.titleMap)&&a.titleMap.some(function(a){return b.equals(a.value,d.$viewValue)});b.isDefined(d.$modelValue)&&!h?l(d):d.$invalid&&d.$validate()}b.isUndefined(d.$modelValue)&&b.isArray(f)&&f.some(function(b,c){return!!(b.default||0===c&&a.reload.preselectFirst)&&(l(d,b.code),!0)})}}function n(a){a.readonly=!0}function o(a){"text"===a.type||"number"===a.type?a.readonly=!1:a.readonly=!a.titleMap.length}function p(a,b,c,e,f,g){var h=k(c),i=m.bind(m,a,b,e,g);n(a),d.when(f(b,h)).then(i).catch(i).finally(o.bind(o,a))}function q(a,b,c){a[c].$viewChangeListeners.push(b)}return{require:["ngModel","^form"],restrict:"AC",priority:500,scope:!1,link:function(c,d,k,l){function m(a){return z.map(f.bind(f,a.arrayIndex)).every(function(a){return r.hasOwnProperty(a)&&e(r[a])})}function n(a){if(a){y();var b=j(c.arrayIndex,r,z),d=p.bind(p,t,c.model,b,o,w.bind(v),x.bind(v));z.every(g.bind(g,b))&&d(),z.forEach(q.bind(q,b,d))}}var o=l[0],r=l[1],s="reloadOptions",t=c.$eval(k[s]),u=t&&t.reload;if(!b.isUndefined(u)){var v=h(u.service),w=i(v,u.fetchAction),x=i(v,u.updateAction);if(!w)return void a.error('Reload directive: Service "'+u.service+'" or fetch function "'+u.fetchAction+'" can not be invoked');if(!x)return void a.error('Reload directive: Service "'+u.service+'" or update function "'+u.updateAction+'" can not be invoked');var y,z=u.watch;y=c.$watch(m,n)}}}}function h(){return{}}function i(a,b){function c(a,b,c,e){var f=d(a);if(f)return f(b,c,e)}function d(c){try{return a.get(c+"Filter")}catch(a){b.error("No filter with the given name found: "+c)}}return function(a,b,d,e){var f;return e.filter&&(f=c(e.filter,a,b,d)),f||a}}var j=b.module("TT-UI.Form.Config",[]);j.constant("FORM_CONFIG",d());var j=b.module("TT-UI.Form.Directives.FieldModelAutopopulate",["schemaForm","TT-UI.Common.Filters.RegExpFilter"]);e.$inject=["$log","escapeFilter"],j.directive("autopopulateTo",e);var j=b.module("TT-UI.Form.Directives.FieldModelPopulate",["schemaForm"]);f.$inject=["$log","$injector","$parse","VALIDATION_EVENTS"],j.directive("populateTo",f);var j=b.module("TT-UI.Form.Directives.FieldReloadOptions",["schemaForm"]);g.$injector=["$log","$injector","$q"],j.directive("reloadOptions",g);try{b.module("TT-UI.FieldValidator.Config")}catch(a){var j=b.module("TT-UI.FieldValidator.Config",[]);j.constant("FIELD_VALIDATOR_CONFIG",h())}var j=b.module("TT-UI.Form.Filters.FormFilter",["schemaForm"]);i.$inject=["$injector","$log"],j.filter("form",i),b.module("TT-UI.Form",["TT-UI.Form.Config","TT-UI.Form.Directives.FieldModelAutopopulate","TT-UI.Form.Directives.FieldModelPopulate","TT-UI.Form.Directives.FieldReloadOptions","TT-UI.Form.Filters.FormFilter"])}(window,window.angular);
//# sourceMappingURL=ttui-form.min.js.map